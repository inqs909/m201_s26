<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Explaining variation, simple &amp; multiple linear models, categorical predictors, correlation, and prediction">

<title>Linear Regression Models – MATH 201</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-62a2cf4b85eca4d1e411543705048ee7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo.png" alt="Class Logo for Math 201" class="navbar-logo light-content">
    <img src="../img/logo.png" alt="Class Logo for Math 201" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MATH 201</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../rcode.html"> 
<span class="menu-text">R Code Reference</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a>
  <ul class="collapse">
  <li><a href="#google-colab" id="toc-google-colab" class="nav-link" data-scroll-target="#google-colab"><span class="header-section-number">1.1</span> Google Colab</a></li>
  <li><a href="#using-the-templates-what-to-change" id="toc-using-the-templates-what-to-change" class="nav-link" data-scroll-target="#using-the-templates-what-to-change"><span class="header-section-number">1.2</span> Using the templates: what to change</a></li>
  </ul></li>
  <li><a href="#visualizing-variables" id="toc-visualizing-variables" class="nav-link" data-scroll-target="#visualizing-variables"><span class="header-section-number">2</span> Visualizing Variables</a>
  <ul class="collapse">
  <li><a href="#scatter-plot-continuous-vs-continuous" id="toc-scatter-plot-continuous-vs-continuous" class="nav-link" data-scroll-target="#scatter-plot-continuous-vs-continuous"><span class="header-section-number">2.1</span> Scatter Plot (Continuous vs Continuous)</a></li>
  <li><a href="#multi-densigy-plot-continuous-vs-categorical" id="toc-multi-densigy-plot-continuous-vs-categorical" class="nav-link" data-scroll-target="#multi-densigy-plot-continuous-vs-categorical"><span class="header-section-number">2.2</span> Multi Densigy Plot (Continuous vs Categorical)</a></li>
  <li><a href="#multi-box-plot-continuous-vs-categorical" id="toc-multi-box-plot-continuous-vs-categorical" class="nav-link" data-scroll-target="#multi-box-plot-continuous-vs-categorical"><span class="header-section-number">2.3</span> Multi Box Plot (Continuous vs Categorical)</a></li>
  </ul></li>
  <li><a href="#modeling-relationships" id="toc-modeling-relationships" class="nav-link" data-scroll-target="#modeling-relationships"><span class="header-section-number">3</span> Modeling Relationships</a>
  <ul class="collapse">
  <li><a href="#explaining-variation" id="toc-explaining-variation" class="nav-link" data-scroll-target="#explaining-variation"><span class="header-section-number">3.1</span> Explaining variation</a></li>
  <li><a href="#a-simple-model-intercept-only" id="toc-a-simple-model-intercept-only" class="nav-link" data-scroll-target="#a-simple-model-intercept-only"><span class="header-section-number">3.2</span> A simple model (intercept-only)</a>
  <ul class="collapse">
  <li><a href="#fitting-simple-model" id="toc-fitting-simple-model" class="nav-link" data-scroll-target="#fitting-simple-model"><span class="header-section-number">3.2.1</span> Fitting Simple Model</a></li>
  </ul></li>
  <li><a href="#linear-regression-model-with-one-predictor" id="toc-linear-regression-model-with-one-predictor" class="nav-link" data-scroll-target="#linear-regression-model-with-one-predictor"><span class="header-section-number">3.3</span> Linear regression model with one predictor</a></li>
  </ul></li>
  <li><a href="#categorical-predictors-dummy-variables" id="toc-categorical-predictors-dummy-variables" class="nav-link" data-scroll-target="#categorical-predictors-dummy-variables"><span class="header-section-number">4</span> Categorical predictors (dummy variables)</a>
  <ul class="collapse">
  <li><a href="#general-idea" id="toc-general-idea" class="nav-link" data-scroll-target="#general-idea"><span class="header-section-number">4.1</span> General idea</a></li>
  <li><a href="#regression-model-with-dummy-variables" id="toc-regression-model-with-dummy-variables" class="nav-link" data-scroll-target="#regression-model-with-dummy-variables"><span class="header-section-number">4.2</span> Regression model with dummy variables</a></li>
  <li><a href="#r-implementation" id="toc-r-implementation" class="nav-link" data-scroll-target="#r-implementation"><span class="header-section-number">4.3</span> R Implementation</a></li>
  <li><a href="#group-statistics" id="toc-group-statistics" class="nav-link" data-scroll-target="#group-statistics"><span class="header-section-number">4.4</span> Group Statistics</a></li>
  </ul></li>
  <li><a href="#strength-correlation" id="toc-strength-correlation" class="nav-link" data-scroll-target="#strength-correlation"><span class="header-section-number">5</span> Strength &amp; correlation</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">6</span> Prediction</a></li>
  <li><a href="#multiple-linear-regression-mlr" id="toc-multiple-linear-regression-mlr" class="nav-link" data-scroll-target="#multiple-linear-regression-mlr"><span class="header-section-number">7</span> Multiple linear regression (MLR)</a>
  <ul class="collapse">
  <li><a href="#adjusted-r2" id="toc-adjusted-r2" class="nav-link" data-scroll-target="#adjusted-r2"><span class="header-section-number">7.1</span> Adjusted <span class="math inline">\(R^2\)</span></a></li>
  </ul></li>
  <li><a href="#appendix-quick-templates-copypaste" id="toc-appendix-quick-templates-copypaste" class="nav-link" data-scroll-target="#appendix-quick-templates-copypaste"><span class="header-section-number">8</span> Appendix: quick templates (copy‑paste)</a>
  <ul class="collapse">
  <li><a href="#simple-model" id="toc-simple-model" class="nav-link" data-scroll-target="#simple-model"><span class="header-section-number">8.1</span> Simple Model</a></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="header-section-number">8.2</span> Simple linear regression</a></li>
  <li><a href="#slr-categorical-predictor" id="toc-slr-categorical-predictor" class="nav-link" data-scroll-target="#slr-categorical-predictor"><span class="header-section-number">8.3</span> SLR: Categorical predictor</a></li>
  <li><a href="#slr-categorical-predictor-create-factor" id="toc-slr-categorical-predictor-create-factor" class="nav-link" data-scroll-target="#slr-categorical-predictor-create-factor"><span class="header-section-number">8.4</span> SLR: Categorical predictor (Create Factor)</a></li>
  <li><a href="#numerical-statistics-by-categories" id="toc-numerical-statistics-by-categories" class="nav-link" data-scroll-target="#numerical-statistics-by-categories"><span class="header-section-number">8.5</span> Numerical Statistics by Categories</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">8.6</span> Correlation</a></li>
  <li><a href="#r2" id="toc-r2" class="nav-link" data-scroll-target="#r2"><span class="header-section-number">8.7</span> <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="header-section-number">8.8</span> Multiple linear regression</a></li>
  <li><a href="#adjusted-r2-1" id="toc-adjusted-r2-1" class="nav-link" data-scroll-target="#adjusted-r2-1"><span class="header-section-number">8.9</span> Adjusted <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#prediction-slr" id="toc-prediction-slr" class="nav-link" data-scroll-target="#prediction-slr"><span class="header-section-number">8.10</span> Prediction: SLR</a></li>
  <li><a href="#prediction-mlr" id="toc-prediction-mlr" class="nav-link" data-scroll-target="#prediction-mlr"><span class="header-section-number">8.11</span> Prediction: MLR</a></li>
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot"><span class="header-section-number">8.12</span> Scatter Plot</a></li>
  <li><a href="#scatter-plot-trend-line" id="toc-scatter-plot-trend-line" class="nav-link" data-scroll-target="#scatter-plot-trend-line"><span class="header-section-number">8.13</span> Scatter Plot + trend line</a></li>
  <li><a href="#multiple-density-plot-continous-vs-categorical" id="toc-multiple-density-plot-continous-vs-categorical" class="nav-link" data-scroll-target="#multiple-density-plot-continous-vs-categorical"><span class="header-section-number">8.14</span> Multiple Density Plot (Continous vs Categorical)</a></li>
  <li><a href="#multiple-box-plots-continous-vs-categorical" id="toc-multiple-box-plots-continous-vs-categorical" class="nav-link" data-scroll-target="#multiple-box-plots-continous-vs-categorical"><span class="header-section-number">8.15</span> Multiple Box Plots (Continous vs Categorical)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Linear Regression Models</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    Explaining variation, simple &amp; multiple linear models, categorical predictors, correlation, and prediction
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<section id="google-colab" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="google-colab"><span class="header-section-number">1.1</span> Google Colab</h2>
<p>Copy the following code and put it in a code cell in Google Colab. Only do this if you are using a completely new notebook.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code will load the R packages we will use</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"rcistats"</span>, <span class="st">"taylor"</span>,,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">"https://inqs909.r-universe.dev"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"https://cloud.r-project.org"</span>)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcistats)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(taylor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="using-the-templates-what-to-change" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="using-the-templates-what-to-change"><span class="header-section-number">1.2</span> Using the templates: what to change</h2>
<ul>
<li><strong><code>DATA</code></strong> → your data frame/tibble (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass_g</code>)</li>
<li><strong><code>X</code>, <code>X1</code>, <code>X2</code>, …, <code>Xp</code></strong> → predictor variables (e.g <code>flipper_length_mm</code>, <code>species</code>)</li>
<li>For categorical predictors: ensure the predictor is a <strong>factor</strong> (use <code>factor(X)</code> if needed).</li>
</ul>
</section>
</section>
<section id="visualizing-variables" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Visualizing Variables</h1>
<section id="scatter-plot-continuous-vs-continuous" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="scatter-plot-continuous-vs-continuous"><span class="header-section-number">2.1</span> Scatter Plot (Continuous vs Continuous)</h2>
<p>A <strong>scatter plot</strong> reveals association, trend direction, and form.</p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">y =</span> body_mass)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" alt="A scatter plot that shows the relationship between flipper length and body mass. The data points show a positive relationship,  and possibly two groups. " width="672"></p>
</section>
<section id="multi-densigy-plot-continuous-vs-categorical" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="multi-densigy-plot-continuous-vs-categorical"><span class="header-section-number">2.2</span> Multi Densigy Plot (Continuous vs Categorical)</h2>
<p>A density plot is a way to visualize the distribution of a continuous variable — it shows where data values are concentrated (dense) and where they are sparse.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Color</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Fill</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Group</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">color =</span> CAT)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" alt="Kernel density plot showing the distribution of penguin flipper lengths by species. Adelie penguins have shorter flippers centered around 190 mm, Chinstrap penguins are intermediate around 195 mm, and Gentoo penguins have much longer flippers centered around 215–220 mm,  with little overlap between Gentoo and the other species." width="672"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">fill =</span> CAT)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" alt="Filled kernel density plot showing the distribution of penguin  flipper lengths by species. Adelie penguins have shorter flippers centered around 190 mm, Chinstrap penguins are intermediate  around 195 mm, and Gentoo penguins have much longer  flippers centered around 215–220 mm,  with little overlap between Gentoo and the other species." width="672"></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">group =</span> CAT)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">group =</span> species)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" alt="Kernel density plot showing the distribution of penguin flipper lengths by species. Adelie penguins have shorter flippers centered around 190 mm, Chinstrap penguins are intermediate around 195 mm, and Gentoo penguins have much longer flippers centered around 215–220 mm,  with little overlap between Gentoo and the other species. " width="672"></p>
</div>
</div>
</div>
</section>
<section id="multi-box-plot-continuous-vs-categorical" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="multi-box-plot-continuous-vs-categorical"><span class="header-section-number">2.3</span> Multi Box Plot (Continuous vs Categorical)</h2>
<p>A <strong>box plot</strong> summarizes median, quartiles, and potential outliers.</p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">y =</span> CAT)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">y =</span> species)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" alt="Horizontal boxplots of penguin flipper lengths (mm) by species. Adelie penguins have the shortest flippers with a median around  190 mm and a few outliers; Chinstrap penguins are intermediate with  a median near 195 mm; and Gentoo penguins have the longest flippers  with a median around 215–220 mm. The distributions show clear  separation between Gentoo and the other species." width="672"></p>
</section>
</section>
<section id="modeling-relationships" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Modeling Relationships</h1>
<section id="explaining-variation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="explaining-variation"><span class="header-section-number">3.1</span> Explaining variation</h2>
<p>This is the process of trying to <strong>reduce unexplained variation</strong> in an outcome by using informative predictors — think <em>getting it less wrong</em> with an educated guess.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="fig-plot-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="672" alt="Kernel density plot of penguin body mass (grams).  The distribution peaks around 3,600–3,800 grams and gradually  tapers toward higher body masses, with a long right tail  extending beyond 6,000 grams. ">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="regression_files/figure-html/fig-plot-1-1.png" id="fig-plot-1" class="img-fluid figure-img" alt="Kernel density plot of penguin body mass (grams).  The distribution peaks around 3,600–3,800 grams and gradually  tapers toward higher body masses, with a long right tail  extending beyond 6,000 grams. " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>If we know some information, we can get less wrong over time.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same variable, grouped by a category (species)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" alt="Filled kernel density plot of penguin body mass (grams) by species.  Adelie penguins (red) and Chinstrap penguins (green) have lower  body masses, with overlapping distributions centered around 3,500–4,000  grams, while Gentoo penguins (blue) are substantially heavier,  with a distribution centered around 4,800–5,500 grams and  little overlap with the other species." width="672"></p>
</section>
<section id="a-simple-model-intercept-only" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="a-simple-model-intercept-only"><span class="header-section-number">3.2</span> A simple model (intercept-only)</h2>
<p>We believe the outcome (<span class="math inline">\(Y\)</span>) is generated by an unknown data generated process (<span class="math inline">\(DGP_1\)</span>): <span class="math inline">\(Y \sim DGP_1\)</span>. A minimal model says all outcomes are generated from a number (labeled as <span class="math inline">\(\beta_0\)</span>) plus or minus some error (<span class="math inline">\(\varepsilon\)</span>):<br>
<span class="math display">\[ Y = \beta_0 + \varepsilon \]</span></p>
<p>This is known as a simple model and the errors are simulated by a different DGP <span class="math inline">\(\varepsilon \sim DGP_2\)</span>. The simple model is unknown, so we construct and estimated simple model for our best guess on how the data is generated:</p>
<p><span class="math display">\[
\hat Y = \hat\beta_0
\]</span></p>
<p>The carats above the letters are known as hats, which means best guess.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observed vs.&nbsp;estimated:</strong></p>
<ul>
<li>Observed <span class="math inline">\(Y = \beta_0 + \varepsilon\)</span></li>
<li>Estimated <span class="math inline">\(\hat Y = \hat\beta_0\)</span></li>
</ul>
</div>
</div>
<section id="fitting-simple-model" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="fitting-simple-model"><span class="header-section-number">3.2.1</span> Fitting Simple Model</h3>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data (e.g., <code>penguins</code>).<br>
</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass_g</code>).</li>
</ul>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null (intercept-only) model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> penguins)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>m0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Call: lm(formula = body_mass ~ 1, data = penguins)</p>
<p>Coefficients: (Intercept)<br>
4207</p>
</section>
</section>
<section id="linear-regression-model-with-one-predictor" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="linear-regression-model-with-one-predictor"><span class="header-section-number">3.3</span> Linear regression model with one predictor</h2>
<p><strong>Model form:</strong></p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \varepsilon, \quad \hat Y = \hat\beta_0 + \hat\beta_1 X.
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(flipper_len, body_mass)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" alt="A scatter plot that shows the relationship between flipper length and body mass. The data points show a positive relationship,  and possibly two groups. " width="672"></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a least-squares line</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(flipper_len, body_mass)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" alt="A scatter plot that shows the relationship between flipper length and body mass. The data points show a positive relationship,  and possibly two groups. There is a line going between the  points showing a positive line." width="672"></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_len, <span class="at">data =</span> penguins)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>m1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Call: lm(formula = body_mass ~ flipper_len, data = penguins)</p>
<p>Coefficients: (Intercept) flipper_len<br>
-5872.09 50.15</p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="categorical-predictors-dummy-variables" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Categorical predictors (dummy variables)</h1>
<p>When we use a <strong>categorical predictor</strong> in a regression, R needs to convert the categories into numbers. This is done using <strong>dummy variables</strong> (also called indicator variables).</p>
<section id="general-idea" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="general-idea"><span class="header-section-number">4.1</span> General idea</h2>
<ul>
<li>Suppose we have a categorical variable with <strong>C categories</strong>.<br>
</li>
<li>We create <strong>C − 1 dummy variables</strong>, each taking value:
<ul>
<li><code>1</code> if the observation belongs to that category<br>
</li>
<li><code>0</code> otherwise<br>
</li>
</ul></li>
<li>The category without a dummy variable becomes the <strong>reference (baseline)</strong> group.</li>
</ul>
<p><strong>Example: Penguin species:</strong></p>
<p>The <code>species</code> variable has 3 categories: <strong>Adelie, Chinstrap, Gentoo</strong>.</p>
<p>We create two dummy variables:</p>
<ul>
<li><span class="math inline">\(D_1\)</span>: 1 if Chinstrap, 0 otherwise<br>
</li>
<li><span class="math inline">\(D_2\)</span>: 1 if Gentoo, 0 otherwise<br>
</li>
<li>Adelie is the reference (when both <span class="math inline">\(D_1 = 0, D_2 = 0\)</span>)</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Species</th>
<th><span class="math inline">\(D_1\)</span> (Chinstrap)</th>
<th><span class="math inline">\(D_2\)</span> (Gentoo)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adelie</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Chinstrap</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Gentoo</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</section>
<section id="regression-model-with-dummy-variables" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="regression-model-with-dummy-variables"><span class="header-section-number">4.2</span> Regression model with dummy variables</h2>
<p>If we model penguin body mass (<span class="math inline">\(Y\)</span>) with species:</p>
<p><span class="math display">\[
\hat Y_i = \beta_0 + \beta_1 D_{1i} + \beta_2 D_{2i}
\]</span></p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: mean of Adelie (reference group)<br>
</li>
<li><span class="math inline">\(\beta_1\)</span>: difference in mean body mass between Chinstrap and Adelie<br>
</li>
<li><span class="math inline">\(\beta_2\)</span>: difference in mean body mass between Gentoo and Adelie</li>
</ul>
<p>Predictions:<br>
- Adelie: <span class="math inline">\(\hat Y = \beta_0\)</span><br>
- Chinstrap: <span class="math inline">\(\hat Y = \beta_0 + \beta_1\)</span><br>
- Gentoo: <span class="math inline">\(\hat Y = \beta_0 + \beta_2\)</span></p>
</section>
<section id="r-implementation" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="r-implementation"><span class="header-section-number">4.3</span> R Implementation</h2>
<p>R automatically creates dummy variables when you use a factor in <code>lm()</code>.<br>
The first level of the factor is used as the <strong>reference group</strong> (by default).</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with species (factor) as predictor</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Call: lm(formula = body_mass ~ species, data = penguins)</p>
<p>Residuals: Min 1Q Median 3Q Max -1142.44 -342.44 -33.09 307.56 1207.56</p>
<p>Coefficients: Estimate Std. Error t value Pr(&gt;|t|)<br>
(Intercept) 3706.16 38.14 97.184 &lt;2e-16 <strong><em> speciesChinstrap 26.92 67.65 0.398 0.691<br>
speciesGentoo 1386.27 56.91 24.359 &lt;2e-16 </em></strong> — Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>Residual standard error: 460.8 on 330 degrees of freedom Multiple R-squared: 0.6745, Adjusted R-squared: 0.6725 F-statistic: 341.9 on 2 and 330 DF, p-value: &lt; 2.2e-16</p>
<p><strong>Templates:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)           <span class="co"># if X is already a factor</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">factor</span>(X), <span class="at">data =</span> DATA)   <span class="co"># force X to be treated as factor</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="group-statistics" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="group-statistics"><span class="header-section-number">4.4</span> Group Statistics</h2>
<p>The function <code>num_by_cat_stats()</code> quickly computes <strong>descriptive statistics of a numerical variable grouped by a categorical variable</strong>.</p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(DATA, NUM, CAT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code>: the data frame (e.g., <code>penguins</code>)</li>
<li><code>NUM</code>: the numerical variable you want to summarize (e.g., <code>body_mass_g</code>)</li>
<li><code>CAT</code>: the categorical variable that defines groups (e.g., <code>species</code>)</li>
</ul>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(penguins, body_mass, species)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Categories min q25 mean median q75 max sd var iqr 1 Adelie 2850 3362.5 3706.164 3700 4000 4775 458.620 210332.4 637.5 2 Chinstrap 2700 3487.5 3733.088 3700 3950 4800 384.335 147713.5 462.5 3 Gentoo 3950 4700.0 5092.437 5050 5500 6300 501.476 251478.3 800.0 missing 1 0 2 0 3 0</p>
</section>
</section>
<section id="strength-correlation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Strength &amp; correlation</h1>
<p>Correlation (two numerical variables): <span class="math inline">\(-1 \le r \le 1\)</span>. For simple linear regression, <span class="math inline">\(R^2 = r^2\)</span>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(penguins<span class="sc">$</span>body_mass, penguins<span class="sc">$</span>flipper_len)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>[1] 0.8729789</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2 helper</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(<span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_leng, <span class="at">data =</span> penguins))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>#&gt; Error:
#&gt; ! object 'flipper_leng' not found</code></pre>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DATA<span class="sc">$</span>Y, DATA<span class="sc">$</span>X)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## R-Squared</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>xlm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA); </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(xlm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="prediction" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Prediction</h1>
<p>Model: <span class="math inline">\(\hat Y = \hat\beta_0 + \hat\beta_1 X\)</span>. Supply new X to get a prediction <span class="math inline">\(\hat Y\)</span>.</p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> VAL)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Examples:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>xlm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(xlm1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">species =</span> <span class="st">"Gentoo"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>   1 </code></pre>
<p>5092.437</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>xlm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_len, <span class="at">data =</span> penguins)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(xlm2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">flipper_len =</span> <span class="dv">190</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>   1 </code></pre>
<p>3657.028</p>
</section>
<section id="multiple-linear-regression-mlr" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Multiple linear regression (MLR)</h1>
<p>Model: <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \varepsilon\)</span></p>
<p><strong>Template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example: danceability ~ mode_name + valence + energy</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: danceability ~ mode_name + valence + energy</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(danceability <span class="sc">~</span> mode_name <span class="sc">+</span> valence <span class="sc">+</span> energy, <span class="at">data =</span> taylor_album_songs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Call: lm(formula = danceability ~ mode_name + valence + energy, data = taylor_album_songs)</p>
<p>Coefficients: (Intercept) mode_nameminor valence energy<br>
0.53816 0.08386 0.17554 -0.05944</p>
<section id="adjusted-r2" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="adjusted-r2"><span class="header-section-number">7.1</span> Adjusted <span class="math inline">\(R^2\)</span></h2>
<p><span class="math display">\[R^2 = 1 - \frac{\text{Var(resid)}}{\text{Var}(Y)}, \quad
R^2_{adj} = 1 - \Big(\frac{\text{Var(resid)}}{\text{Var}(Y)}\Big) \cdot \frac{n-1}{n-k-1}\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(danceability <span class="sc">~</span> mode_name <span class="sc">+</span> valence <span class="sc">+</span> energy, <span class="at">data =</span> taylor_album_songs)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ar2</span>(m)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>[1] 0.09148268</p>
</section>
</section>
<section id="appendix-quick-templates-copypaste" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Appendix: quick templates (copy‑paste)</h1>
<section id="simple-model" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="simple-model"><span class="header-section-number">8.1</span> Simple Model</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
</ul>
</section>
<section id="simple-linear-regression" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="simple-linear-regression"><span class="header-section-number">8.2</span> Simple linear regression</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>flipper_length_mm</code>)</li>
</ul>
</section>
<section id="slr-categorical-predictor" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="slr-categorical-predictor"><span class="header-section-number">8.3</span> SLR: Categorical predictor</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>species</code>)</li>
</ul>
</section>
<section id="slr-categorical-predictor-create-factor" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="slr-categorical-predictor-create-factor"><span class="header-section-number">8.4</span> SLR: Categorical predictor (Create Factor)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">factor</span>(X), <span class="at">data =</span> DATA)   <span class="co"># coerce X to factor</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>species</code>)</li>
</ul>
</section>
<section id="numerical-statistics-by-categories" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="numerical-statistics-by-categories"><span class="header-section-number">8.5</span> Numerical Statistics by Categories</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(DATA, NUM, CAT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code>: the data frame (e.g., <code>penguins</code>)</li>
<li><code>NUM</code>: the numerical variable you want to summarize (e.g., <code>body_mass</code>)</li>
<li><code>CAT</code>: the categorical variable that defines groups (e.g., <code>species</code>)</li>
</ul>
</section>
<section id="correlation" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="correlation"><span class="header-section-number">8.6</span> Correlation</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DATA<span class="sc">$</span>Y, DATA<span class="sc">$</span>X, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>flipper_len</code>)</li>
</ul>
</section>
<section id="r2" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="r2"><span class="header-section-number">8.7</span> <span class="math inline">\(R^2\)</span></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(m)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>flipper_len</code>)</li>
</ul>
</section>
<section id="multiple-linear-regression" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="multiple-linear-regression"><span class="header-section-number">8.8</span> Multiple linear regression</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X1</code>, <code>X2</code>, …, <code>Xp</code></strong> → predictor variables (e.g <code>flipper_len</code>, <code>species</code>)</li>
</ul>
</section>
<section id="adjusted-r2-1" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="adjusted-r2-1"><span class="header-section-number">8.9</span> Adjusted <span class="math inline">\(R^2\)</span></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R^2</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ar2</span>(m)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X1</code>, <code>X2</code>, …, <code>Xp</code></strong> → predictor variables (e.g <code>flipper_len</code>, <code>species</code>)</li>
</ul>
</section>
<section id="prediction-slr" class="level2" data-number="8.10">
<h2 data-number="8.10" class="anchored" data-anchor-id="prediction-slr"><span class="header-section-number">8.10</span> Prediction: SLR</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> VAL)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X</code></strong> → predictor variables (e.g <code>flipper_len</code>)</li>
</ul>
</section>
<section id="prediction-mlr" class="level2" data-number="8.11">
<h2 data-number="8.11" class="anchored" data-anchor-id="prediction-mlr"><span class="header-section-number">8.11</span> Prediction: MLR</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> VAL1, <span class="at">X2 =</span> VAL2, ..., <span class="at">Xp =</span> VALp)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong><code>DATA</code></strong> → your data frame (e.g., <code>penguins</code>)</li>
<li><strong><code>Y</code></strong> → the outcome variable (e.g., <code>body_mass</code>)</li>
<li><strong><code>X1</code>, <code>X2</code>, …, <code>Xp</code></strong> → predictor variables (e.g <code>flipper_len</code>, <code>species</code>)</li>
<li><strong><code>VAL1</code>, <code>VAL2</code>, …, <code>VALp</code></strong> → predictor values (e.g <code>150</code>, <code>"Gentoo"</code>)</li>
</ul>
</section>
<section id="scatter-plot" class="level2" data-number="8.12">
<h2 data-number="8.12" class="anchored" data-anchor-id="scatter-plot"><span class="header-section-number">8.12</span> Scatter Plot</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code> → the name of your dataset (e.g., <code>penguins</code>).</li>
<li><code>VAR1</code> → a single numerical variable (e.g., <code>body_mass</code>).</li>
<li><code>VAR2</code> → a single numerical variable (e.g., <code>flipper_len</code>).</li>
</ul>
</section>
<section id="scatter-plot-trend-line" class="level2" data-number="8.13">
<h2 data-number="8.13" class="anchored" data-anchor-id="scatter-plot-trend-line"><span class="header-section-number">8.13</span> Scatter Plot + trend line</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code> → the name of your dataset (e.g., <code>penguins</code>).</li>
<li><code>VAR1</code> → a single numerical variable (e.g., <code>body_mass</code>).</li>
<li><code>VAR2</code> → a single numerical variable (e.g., <code>flipper_len</code>).</li>
</ul>
</section>
<section id="multiple-density-plot-continous-vs-categorical" class="level2" data-number="8.14">
<h2 data-number="8.14" class="anchored" data-anchor-id="multiple-density-plot-continous-vs-categorical"><span class="header-section-number">8.14</span> Multiple Density Plot (Continous vs Categorical)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">color =</span> CAT)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code> → the name of your dataset (e.g., <code>penguins</code>).</li>
<li><code>NUM</code> → a single numerical variable (e.g., <code>body_mass</code>).</li>
<li><code>CAT</code> → a single categorical variable (e.g., <code>species</code>).</li>
</ul>
</section>
<section id="multiple-box-plots-continous-vs-categorical" class="level2" data-number="8.15">
<h2 data-number="8.15" class="anchored" data-anchor-id="multiple-box-plots-continous-vs-categorical"><span class="header-section-number">8.15</span> Multiple Box Plots (Continous vs Categorical)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">y =</span> CAT)) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>DATA</code> → the name of your dataset (e.g., <code>penguins</code>).</li>
<li><code>NUM</code> → a single numerical variable (e.g., <code>body_mass</code>).</li>
<li><code>CAT</code> → a single categorical variable (e.g., <code>species</code>).</li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("www\.inqs\.info\/m201_s26");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Linear Regression Models"</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Explaining variation, simple &amp; multiple linear models, categorical predictors, correlation, and prediction"</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> img/linear.png</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co">  error: true</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> r</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">    comment: "#&gt;"</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">    results: asis</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcistats)</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ThemePark)</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(taylor)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Google Colab</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>Copy the following code and put it in a code cell in Google Colab. Only do this if you are using a completely new notebook.</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="co"># This code will load the R packages we will use</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"rcistats"</span>, <span class="st">"taylor"</span>,,</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">"https://inqs909.r-universe.dev"</span>, </span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"https://cloud.r-project.org"</span>)))</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcistats)</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(taylor)</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using the templates: what to change</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame/tibble (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass_g`</span>)</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`, `X1`, `X2`, ..., `Xp`** → predictor variables (e.g <span class="in">`flipper_length_mm`</span>, <span class="in">`species`</span>)</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For categorical predictors: ensure the predictor is a **factor** (use <span class="in">`factor(X)`</span> if needed).</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualizing Variables</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scatter Plot (Continuous vs Continuous)</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>A **scatter plot** reveals association, trend direction, and form.</span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a><span class="co">#|   A scatter plot that shows the relationship between flipper length</span></span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and body mass. The data points show a positive relationship, </span></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and possibly two groups. </span></span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">y =</span> body_mass)) <span class="sc">+</span></span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multi Densigy Plot (Continuous vs Categorical)</span></span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>A density plot is a way to visualize the distribution of a continuous variable — it shows where data values are concentrated (dense) and where they are sparse.</span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-103"><a href="#cb51-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### Color</span></span>
<span id="cb51-104"><a href="#cb51-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-107"><a href="#cb51-107" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-108"><a href="#cb51-108" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">color =</span> CAT)) <span class="sc">+</span></span>
<span id="cb51-109"><a href="#cb51-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-110"><a href="#cb51-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-111"><a href="#cb51-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-112"><a href="#cb51-112" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-113"><a href="#cb51-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-116"><a href="#cb51-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-117"><a href="#cb51-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-118"><a href="#cb51-118" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Kernel density plot showing the distribution of penguin flipper lengths</span></span>
<span id="cb51-119"><a href="#cb51-119" aria-hidden="true" tabindex="-1"></a><span class="co">#|   by species. Adelie penguins have shorter flippers centered around 190 mm,</span></span>
<span id="cb51-120"><a href="#cb51-120" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Chinstrap penguins are intermediate around 195 mm, and Gentoo penguins</span></span>
<span id="cb51-121"><a href="#cb51-121" aria-hidden="true" tabindex="-1"></a><span class="co">#|   have much longer flippers centered around 215–220 mm, </span></span>
<span id="cb51-122"><a href="#cb51-122" aria-hidden="true" tabindex="-1"></a><span class="co">#|   with little overlap between Gentoo and the other species.</span></span>
<span id="cb51-123"><a href="#cb51-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-124"><a href="#cb51-124" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb51-125"><a href="#cb51-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-126"><a href="#cb51-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-127"><a href="#cb51-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-128"><a href="#cb51-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fill</span></span>
<span id="cb51-129"><a href="#cb51-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-130"><a href="#cb51-130" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-131"><a href="#cb51-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-132"><a href="#cb51-132" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-133"><a href="#cb51-133" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">fill =</span> CAT)) <span class="sc">+</span></span>
<span id="cb51-134"><a href="#cb51-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-135"><a href="#cb51-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-136"><a href="#cb51-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-137"><a href="#cb51-137" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-138"><a href="#cb51-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-141"><a href="#cb51-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-142"><a href="#cb51-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-143"><a href="#cb51-143" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Filled kernel density plot showing the distribution of penguin </span></span>
<span id="cb51-144"><a href="#cb51-144" aria-hidden="true" tabindex="-1"></a><span class="co">#|   flipper lengths by species. Adelie penguins have shorter flippers</span></span>
<span id="cb51-145"><a href="#cb51-145" aria-hidden="true" tabindex="-1"></a><span class="co">#|   centered around 190 mm, Chinstrap penguins are intermediate </span></span>
<span id="cb51-146"><a href="#cb51-146" aria-hidden="true" tabindex="-1"></a><span class="co">#|   around 195 mm, and Gentoo penguins have much longer </span></span>
<span id="cb51-147"><a href="#cb51-147" aria-hidden="true" tabindex="-1"></a><span class="co">#|   flippers centered around 215–220 mm, </span></span>
<span id="cb51-148"><a href="#cb51-148" aria-hidden="true" tabindex="-1"></a><span class="co">#|   with little overlap between Gentoo and the other species.</span></span>
<span id="cb51-149"><a href="#cb51-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-150"><a href="#cb51-150" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb51-151"><a href="#cb51-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-152"><a href="#cb51-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-153"><a href="#cb51-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-154"><a href="#cb51-154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Group</span></span>
<span id="cb51-155"><a href="#cb51-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-156"><a href="#cb51-156" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-157"><a href="#cb51-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-158"><a href="#cb51-158" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-159"><a href="#cb51-159" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">group =</span> CAT)) <span class="sc">+</span></span>
<span id="cb51-160"><a href="#cb51-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-161"><a href="#cb51-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-162"><a href="#cb51-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-163"><a href="#cb51-163" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-164"><a href="#cb51-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-167"><a href="#cb51-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-168"><a href="#cb51-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-169"><a href="#cb51-169" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Kernel density plot showing the distribution of penguin flipper lengths</span></span>
<span id="cb51-170"><a href="#cb51-170" aria-hidden="true" tabindex="-1"></a><span class="co">#|   by species. Adelie penguins have shorter flippers centered around 190 mm,</span></span>
<span id="cb51-171"><a href="#cb51-171" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Chinstrap penguins are intermediate around 195 mm, and Gentoo penguins</span></span>
<span id="cb51-172"><a href="#cb51-172" aria-hidden="true" tabindex="-1"></a><span class="co">#|   have much longer flippers centered around 215–220 mm, </span></span>
<span id="cb51-173"><a href="#cb51-173" aria-hidden="true" tabindex="-1"></a><span class="co">#|   with little overlap between Gentoo and the other species.</span></span>
<span id="cb51-174"><a href="#cb51-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb51-175"><a href="#cb51-175" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">group =</span> species)) <span class="sc">+</span></span>
<span id="cb51-176"><a href="#cb51-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-177"><a href="#cb51-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-178"><a href="#cb51-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-179"><a href="#cb51-179" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-180"><a href="#cb51-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-181"><a href="#cb51-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multi Box Plot (Continuous vs Categorical)</span></span>
<span id="cb51-182"><a href="#cb51-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-183"><a href="#cb51-183" aria-hidden="true" tabindex="-1"></a>A **box plot** summarizes median, quartiles, and potential outliers.</span>
<span id="cb51-184"><a href="#cb51-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-185"><a href="#cb51-185" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-186"><a href="#cb51-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-187"><a href="#cb51-187" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-188"><a href="#cb51-188" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">y =</span> CAT)) <span class="sc">+</span></span>
<span id="cb51-189"><a href="#cb51-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb51-190"><a href="#cb51-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-191"><a href="#cb51-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-192"><a href="#cb51-192" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-193"><a href="#cb51-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-196"><a href="#cb51-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-197"><a href="#cb51-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-198"><a href="#cb51-198" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Horizontal boxplots of penguin flipper lengths (mm) by species.</span></span>
<span id="cb51-199"><a href="#cb51-199" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Adelie penguins have the shortest flippers with a median around </span></span>
<span id="cb51-200"><a href="#cb51-200" aria-hidden="true" tabindex="-1"></a><span class="co">#|   190 mm and a few outliers; Chinstrap penguins are intermediate with </span></span>
<span id="cb51-201"><a href="#cb51-201" aria-hidden="true" tabindex="-1"></a><span class="co">#|   a median near 195 mm; and Gentoo penguins have the longest flippers </span></span>
<span id="cb51-202"><a href="#cb51-202" aria-hidden="true" tabindex="-1"></a><span class="co">#|   with a median around 215–220 mm. The distributions show clear </span></span>
<span id="cb51-203"><a href="#cb51-203" aria-hidden="true" tabindex="-1"></a><span class="co">#|   separation between Gentoo and the other species.</span></span>
<span id="cb51-204"><a href="#cb51-204" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_len, <span class="at">y =</span> species)) <span class="sc">+</span></span>
<span id="cb51-205"><a href="#cb51-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb51-206"><a href="#cb51-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-207"><a href="#cb51-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-208"><a href="#cb51-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-209"><a href="#cb51-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-210"><a href="#cb51-210" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modeling Relationships</span></span>
<span id="cb51-211"><a href="#cb51-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-212"><a href="#cb51-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Explaining variation</span></span>
<span id="cb51-213"><a href="#cb51-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-214"><a href="#cb51-214" aria-hidden="true" tabindex="-1"></a>This is the process of trying to **reduce unexplained variation** in an outcome by using informative predictors — think *getting it less wrong* with an educated guess.</span>
<span id="cb51-215"><a href="#cb51-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-218"><a href="#cb51-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-219"><a href="#cb51-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-220"><a href="#cb51-220" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Kernel density plot of penguin body mass (grams). </span></span>
<span id="cb51-221"><a href="#cb51-221" aria-hidden="true" tabindex="-1"></a><span class="co">#|   The distribution peaks around 3,600–3,800 grams and gradually </span></span>
<span id="cb51-222"><a href="#cb51-222" aria-hidden="true" tabindex="-1"></a><span class="co">#|   tapers toward higher body masses, with a long right tail </span></span>
<span id="cb51-223"><a href="#cb51-223" aria-hidden="true" tabindex="-1"></a><span class="co">#|   extending beyond 6,000 grams.</span></span>
<span id="cb51-224"><a href="#cb51-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-1</span></span>
<span id="cb51-225"><a href="#cb51-225" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass)) <span class="sc">+</span></span>
<span id="cb51-226"><a href="#cb51-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb51-227"><a href="#cb51-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-228"><a href="#cb51-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-229"><a href="#cb51-229" aria-hidden="true" tabindex="-1"></a>If we know some information, we can get less wrong over time.</span>
<span id="cb51-230"><a href="#cb51-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-233"><a href="#cb51-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-234"><a href="#cb51-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-235"><a href="#cb51-235" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Filled kernel density plot of penguin body mass (grams) by species. </span></span>
<span id="cb51-236"><a href="#cb51-236" aria-hidden="true" tabindex="-1"></a><span class="co">#|   Adelie penguins (red) and Chinstrap penguins (green) have lower </span></span>
<span id="cb51-237"><a href="#cb51-237" aria-hidden="true" tabindex="-1"></a><span class="co">#|   body masses, with overlapping distributions centered around 3,500–4,000 </span></span>
<span id="cb51-238"><a href="#cb51-238" aria-hidden="true" tabindex="-1"></a><span class="co">#|   grams, while Gentoo penguins (blue) are substantially heavier, </span></span>
<span id="cb51-239"><a href="#cb51-239" aria-hidden="true" tabindex="-1"></a><span class="co">#|   with a distribution centered around 4,800–5,500 grams and </span></span>
<span id="cb51-240"><a href="#cb51-240" aria-hidden="true" tabindex="-1"></a><span class="co">#|   little overlap with the other species.</span></span>
<span id="cb51-241"><a href="#cb51-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Same variable, grouped by a category (species)</span></span>
<span id="cb51-242"><a href="#cb51-242" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb51-243"><a href="#cb51-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)</span>
<span id="cb51-244"><a href="#cb51-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-245"><a href="#cb51-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-246"><a href="#cb51-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## A simple model (intercept-only)</span></span>
<span id="cb51-247"><a href="#cb51-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-248"><a href="#cb51-248" aria-hidden="true" tabindex="-1"></a>We believe the outcome ($Y$) is generated by an unknown data generated process ($DGP_1$): $Y \sim DGP_1$. A minimal model says all outcomes are generated from a number (labeled as $\beta_0$) plus or minus some error ($\varepsilon$):\</span>
<span id="cb51-249"><a href="#cb51-249" aria-hidden="true" tabindex="-1"></a>$$ Y = \beta_0 + \varepsilon $$</span>
<span id="cb51-250"><a href="#cb51-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-251"><a href="#cb51-251" aria-hidden="true" tabindex="-1"></a>This is known as a simple model and the errors are simulated by a different DGP $\varepsilon \sim DGP_2$. The simple model is unknown, so we construct and estimated simple model for our best guess on how the data is generated:</span>
<span id="cb51-252"><a href="#cb51-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-253"><a href="#cb51-253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-254"><a href="#cb51-254" aria-hidden="true" tabindex="-1"></a>\hat Y = \hat\beta_0</span>
<span id="cb51-255"><a href="#cb51-255" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-256"><a href="#cb51-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-257"><a href="#cb51-257" aria-hidden="true" tabindex="-1"></a>The carats above the letters are known as hats, which means best guess.</span>
<span id="cb51-258"><a href="#cb51-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-259"><a href="#cb51-259" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb51-260"><a href="#cb51-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-261"><a href="#cb51-261" aria-hidden="true" tabindex="-1"></a>**Observed vs. estimated:**</span>
<span id="cb51-262"><a href="#cb51-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-263"><a href="#cb51-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Observed $Y = \beta_0 + \varepsilon$</span>
<span id="cb51-264"><a href="#cb51-264" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated $\hat Y = \hat\beta_0$</span>
<span id="cb51-265"><a href="#cb51-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-266"><a href="#cb51-266" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-267"><a href="#cb51-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-268"><a href="#cb51-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting Simple Model</span></span>
<span id="cb51-269"><a href="#cb51-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-270"><a href="#cb51-270" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-271"><a href="#cb51-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-272"><a href="#cb51-272" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-273"><a href="#cb51-273" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> DATA)</span>
<span id="cb51-274"><a href="#cb51-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-275"><a href="#cb51-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-276"><a href="#cb51-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data (e.g., <span class="in">`penguins`</span>).\</span>
<span id="cb51-277"><a href="#cb51-277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass_g`</span>).</span>
<span id="cb51-278"><a href="#cb51-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-279"><a href="#cb51-279" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-280"><a href="#cb51-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-283"><a href="#cb51-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-284"><a href="#cb51-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null (intercept-only) model</span></span>
<span id="cb51-285"><a href="#cb51-285" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> penguins)</span>
<span id="cb51-286"><a href="#cb51-286" aria-hidden="true" tabindex="-1"></a>m0</span>
<span id="cb51-287"><a href="#cb51-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-288"><a href="#cb51-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-289"><a href="#cb51-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression model with one predictor</span></span>
<span id="cb51-290"><a href="#cb51-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-291"><a href="#cb51-291" aria-hidden="true" tabindex="-1"></a>**Model form:**</span>
<span id="cb51-292"><a href="#cb51-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-293"><a href="#cb51-293" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-294"><a href="#cb51-294" aria-hidden="true" tabindex="-1"></a>Y = \beta_0 + \beta_1 X + \varepsilon, \quad \hat Y = \hat\beta_0 + \hat\beta_1 X.</span>
<span id="cb51-295"><a href="#cb51-295" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-296"><a href="#cb51-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-299"><a href="#cb51-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-300"><a href="#cb51-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-301"><a href="#cb51-301" aria-hidden="true" tabindex="-1"></a><span class="co">#|   A scatter plot that shows the relationship between flipper length</span></span>
<span id="cb51-302"><a href="#cb51-302" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and body mass. The data points show a positive relationship, </span></span>
<span id="cb51-303"><a href="#cb51-303" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and possibly two groups. </span></span>
<span id="cb51-304"><a href="#cb51-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb51-305"><a href="#cb51-305" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(flipper_len, body_mass)) <span class="sc">+</span></span>
<span id="cb51-306"><a href="#cb51-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb51-307"><a href="#cb51-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-308"><a href="#cb51-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-311"><a href="#cb51-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-312"><a href="#cb51-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: |</span></span>
<span id="cb51-313"><a href="#cb51-313" aria-hidden="true" tabindex="-1"></a><span class="co">#|   A scatter plot that shows the relationship between flipper length</span></span>
<span id="cb51-314"><a href="#cb51-314" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and body mass. The data points show a positive relationship, </span></span>
<span id="cb51-315"><a href="#cb51-315" aria-hidden="true" tabindex="-1"></a><span class="co">#|   and possibly two groups. There is a line going between the </span></span>
<span id="cb51-316"><a href="#cb51-316" aria-hidden="true" tabindex="-1"></a><span class="co">#|   points showing a positive line.</span></span>
<span id="cb51-317"><a href="#cb51-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a least-squares line</span></span>
<span id="cb51-318"><a href="#cb51-318" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(flipper_len, body_mass)) <span class="sc">+</span></span>
<span id="cb51-319"><a href="#cb51-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-320"><a href="#cb51-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-321"><a href="#cb51-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-322"><a href="#cb51-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-325"><a href="#cb51-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-326"><a href="#cb51-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb51-327"><a href="#cb51-327" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_len, <span class="at">data =</span> penguins)</span>
<span id="cb51-328"><a href="#cb51-328" aria-hidden="true" tabindex="-1"></a>m1</span>
<span id="cb51-329"><a href="#cb51-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-330"><a href="#cb51-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-331"><a href="#cb51-331" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-332"><a href="#cb51-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-333"><a href="#cb51-333" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-334"><a href="#cb51-334" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb51-335"><a href="#cb51-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-336"><a href="#cb51-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-337"><a href="#cb51-337" aria-hidden="true" tabindex="-1"></a><span class="fu"># Categorical predictors (dummy variables)</span></span>
<span id="cb51-338"><a href="#cb51-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-339"><a href="#cb51-339" aria-hidden="true" tabindex="-1"></a>When we use a **categorical predictor** in a regression, R needs to convert the categories into numbers. This is done using **dummy variables** (also called indicator variables).</span>
<span id="cb51-340"><a href="#cb51-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-341"><a href="#cb51-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## General idea</span></span>
<span id="cb51-342"><a href="#cb51-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-343"><a href="#cb51-343" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Suppose we have a categorical variable with **C categories**.\</span>
<span id="cb51-344"><a href="#cb51-344" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We create **C − 1 dummy variables**, each taking value:</span>
<span id="cb51-345"><a href="#cb51-345" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`1`</span> if the observation belongs to that category\</span>
<span id="cb51-346"><a href="#cb51-346" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`0`</span> otherwise\</span>
<span id="cb51-347"><a href="#cb51-347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The category without a dummy variable becomes the **reference (baseline)** group.</span>
<span id="cb51-348"><a href="#cb51-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-349"><a href="#cb51-349" aria-hidden="true" tabindex="-1"></a>**Example: Penguin species:**</span>
<span id="cb51-350"><a href="#cb51-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-351"><a href="#cb51-351" aria-hidden="true" tabindex="-1"></a>The <span class="in">`species`</span> variable has 3 categories: **Adelie, Chinstrap, Gentoo**.</span>
<span id="cb51-352"><a href="#cb51-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-353"><a href="#cb51-353" aria-hidden="true" tabindex="-1"></a>We create two dummy variables:</span>
<span id="cb51-354"><a href="#cb51-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-355"><a href="#cb51-355" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$D_1$: 1 if Chinstrap, 0 otherwise\</span>
<span id="cb51-356"><a href="#cb51-356" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$D_2$: 1 if Gentoo, 0 otherwise\</span>
<span id="cb51-357"><a href="#cb51-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adelie is the reference (when both $D_1 = 0, D_2 = 0$)</span>
<span id="cb51-358"><a href="#cb51-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-359"><a href="#cb51-359" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Species   <span class="pp">|</span> $D_1$ (Chinstrap) <span class="pp">|</span> $D_2$ (Gentoo) <span class="pp">|</span></span>
<span id="cb51-360"><a href="#cb51-360" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|-------------------|----------------|</span></span>
<span id="cb51-361"><a href="#cb51-361" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Adelie    <span class="pp">|</span> 0                 <span class="pp">|</span> 0              <span class="pp">|</span></span>
<span id="cb51-362"><a href="#cb51-362" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Chinstrap <span class="pp">|</span> 1                 <span class="pp">|</span> 0              <span class="pp">|</span></span>
<span id="cb51-363"><a href="#cb51-363" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Gentoo    <span class="pp">|</span> 0                 <span class="pp">|</span> 1              <span class="pp">|</span></span>
<span id="cb51-364"><a href="#cb51-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-365"><a href="#cb51-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression model with dummy variables</span></span>
<span id="cb51-366"><a href="#cb51-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-367"><a href="#cb51-367" aria-hidden="true" tabindex="-1"></a>If we model penguin body mass ($Y$) with species:</span>
<span id="cb51-368"><a href="#cb51-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-369"><a href="#cb51-369" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-370"><a href="#cb51-370" aria-hidden="true" tabindex="-1"></a>\hat Y_i = \beta_0 + \beta_1 D_{1i} + \beta_2 D_{2i}</span>
<span id="cb51-371"><a href="#cb51-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb51-372"><a href="#cb51-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-373"><a href="#cb51-373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_0$: mean of Adelie (reference group)\</span>
<span id="cb51-374"><a href="#cb51-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_1$: difference in mean body mass between Chinstrap and Adelie\</span>
<span id="cb51-375"><a href="#cb51-375" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_2$: difference in mean body mass between Gentoo and Adelie</span>
<span id="cb51-376"><a href="#cb51-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-377"><a href="#cb51-377" aria-hidden="true" tabindex="-1"></a>Predictions:\</span>
<span id="cb51-378"><a href="#cb51-378" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adelie: $\hat Y = \beta_0$\</span>
<span id="cb51-379"><a href="#cb51-379" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Chinstrap: $\hat Y = \beta_0 + \beta_1$\</span>
<span id="cb51-380"><a href="#cb51-380" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gentoo: $\hat Y = \beta_0 + \beta_2$</span>
<span id="cb51-381"><a href="#cb51-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-382"><a href="#cb51-382" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Implementation</span></span>
<span id="cb51-383"><a href="#cb51-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-384"><a href="#cb51-384" aria-hidden="true" tabindex="-1"></a>R automatically creates dummy variables when you use a factor in <span class="in">`lm()`</span>.\</span>
<span id="cb51-385"><a href="#cb51-385" aria-hidden="true" tabindex="-1"></a>The first level of the factor is used as the **reference group** (by default).</span>
<span id="cb51-386"><a href="#cb51-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-389"><a href="#cb51-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-390"><a href="#cb51-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with species (factor) as predictor</span></span>
<span id="cb51-391"><a href="#cb51-391" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb51-392"><a href="#cb51-392" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span>
<span id="cb51-393"><a href="#cb51-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-394"><a href="#cb51-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-395"><a href="#cb51-395" aria-hidden="true" tabindex="-1"></a>**Templates:**</span>
<span id="cb51-396"><a href="#cb51-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-397"><a href="#cb51-397" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-398"><a href="#cb51-398" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)           <span class="co"># if X is already a factor</span></span>
<span id="cb51-399"><a href="#cb51-399" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">factor</span>(X), <span class="at">data =</span> DATA)   <span class="co"># force X to be treated as factor</span></span>
<span id="cb51-400"><a href="#cb51-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-401"><a href="#cb51-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-402"><a href="#cb51-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Group Statistics</span></span>
<span id="cb51-403"><a href="#cb51-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-404"><a href="#cb51-404" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`num_by_cat_stats()`</span> quickly computes **descriptive statistics of a numerical variable grouped by a categorical variable**.</span>
<span id="cb51-405"><a href="#cb51-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-406"><a href="#cb51-406" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-407"><a href="#cb51-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-408"><a href="#cb51-408" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-409"><a href="#cb51-409" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(DATA, NUM, CAT)</span>
<span id="cb51-410"><a href="#cb51-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-411"><a href="#cb51-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-412"><a href="#cb51-412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DATA`</span>: the data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-413"><a href="#cb51-413" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`NUM`</span>: the numerical variable you want to summarize (e.g., <span class="in">`body_mass_g`</span>)</span>
<span id="cb51-414"><a href="#cb51-414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`CAT`</span>: the categorical variable that defines groups (e.g., <span class="in">`species`</span>)</span>
<span id="cb51-415"><a href="#cb51-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-416"><a href="#cb51-416" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb51-417"><a href="#cb51-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-420"><a href="#cb51-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-421"><a href="#cb51-421" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(penguins, body_mass, species)</span>
<span id="cb51-422"><a href="#cb51-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-423"><a href="#cb51-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-424"><a href="#cb51-424" aria-hidden="true" tabindex="-1"></a><span class="fu"># Strength &amp; correlation</span></span>
<span id="cb51-425"><a href="#cb51-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-426"><a href="#cb51-426" aria-hidden="true" tabindex="-1"></a>Correlation (two numerical variables): $-1 \le r \le 1$. For simple linear regression, $R^2 = r^2$.</span>
<span id="cb51-427"><a href="#cb51-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-430"><a href="#cb51-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-431"><a href="#cb51-431" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(penguins<span class="sc">$</span>body_mass, penguins<span class="sc">$</span>flipper_len)</span>
<span id="cb51-432"><a href="#cb51-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-433"><a href="#cb51-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-436"><a href="#cb51-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-437"><a href="#cb51-437" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2 helper</span></span>
<span id="cb51-438"><a href="#cb51-438" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(<span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_leng, <span class="at">data =</span> penguins))</span>
<span id="cb51-439"><a href="#cb51-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-440"><a href="#cb51-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-441"><a href="#cb51-441" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-442"><a href="#cb51-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-443"><a href="#cb51-443" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-444"><a href="#cb51-444" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb51-445"><a href="#cb51-445" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DATA<span class="sc">$</span>Y, DATA<span class="sc">$</span>X)</span>
<span id="cb51-446"><a href="#cb51-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-447"><a href="#cb51-447" aria-hidden="true" tabindex="-1"></a><span class="do">## R-Squared</span></span>
<span id="cb51-448"><a href="#cb51-448" aria-hidden="true" tabindex="-1"></a>xlm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA); </span>
<span id="cb51-449"><a href="#cb51-449" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(xlm)</span>
<span id="cb51-450"><a href="#cb51-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-451"><a href="#cb51-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-452"><a href="#cb51-452" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction</span></span>
<span id="cb51-453"><a href="#cb51-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-454"><a href="#cb51-454" aria-hidden="true" tabindex="-1"></a>Model: $\hat Y = \hat\beta_0 + \hat\beta_1 X$. Supply new X to get a prediction $\hat Y$.</span>
<span id="cb51-455"><a href="#cb51-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-456"><a href="#cb51-456" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-457"><a href="#cb51-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-458"><a href="#cb51-458" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-459"><a href="#cb51-459" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb51-460"><a href="#cb51-460" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> VAL)</span>
<span id="cb51-461"><a href="#cb51-461" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span>
<span id="cb51-462"><a href="#cb51-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-463"><a href="#cb51-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-464"><a href="#cb51-464" aria-hidden="true" tabindex="-1"></a>**Examples:**</span>
<span id="cb51-465"><a href="#cb51-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-468"><a href="#cb51-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-469"><a href="#cb51-469" aria-hidden="true" tabindex="-1"></a>xlm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb51-470"><a href="#cb51-470" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(xlm1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">species =</span> <span class="st">"Gentoo"</span>))</span>
<span id="cb51-471"><a href="#cb51-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-472"><a href="#cb51-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-475"><a href="#cb51-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-476"><a href="#cb51-476" aria-hidden="true" tabindex="-1"></a>xlm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass <span class="sc">~</span> flipper_len, <span class="at">data =</span> penguins)</span>
<span id="cb51-477"><a href="#cb51-477" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(xlm2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">flipper_len =</span> <span class="dv">190</span>))</span>
<span id="cb51-478"><a href="#cb51-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-479"><a href="#cb51-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-480"><a href="#cb51-480" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple linear regression (MLR)</span></span>
<span id="cb51-481"><a href="#cb51-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-482"><a href="#cb51-482" aria-hidden="true" tabindex="-1"></a>Model: $Y = \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \varepsilon$</span>
<span id="cb51-483"><a href="#cb51-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-484"><a href="#cb51-484" aria-hidden="true" tabindex="-1"></a>**Template:**</span>
<span id="cb51-485"><a href="#cb51-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-486"><a href="#cb51-486" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-487"><a href="#cb51-487" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb51-488"><a href="#cb51-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-489"><a href="#cb51-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-490"><a href="#cb51-490" aria-hidden="true" tabindex="-1"></a>**Example: danceability \~ mode_name + valence + energy**</span>
<span id="cb51-491"><a href="#cb51-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-494"><a href="#cb51-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-495"><a href="#cb51-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: danceability ~ mode_name + valence + energy</span></span>
<span id="cb51-496"><a href="#cb51-496" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(danceability <span class="sc">~</span> mode_name <span class="sc">+</span> valence <span class="sc">+</span> energy, <span class="at">data =</span> taylor_album_songs)</span>
<span id="cb51-497"><a href="#cb51-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-498"><a href="#cb51-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-499"><a href="#cb51-499" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjusted $R^2$</span></span>
<span id="cb51-500"><a href="#cb51-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-501"><a href="#cb51-501" aria-hidden="true" tabindex="-1"></a>$$R^2 = 1 - \frac{\text{Var(resid)}}{\text{Var}(Y)}, \quad</span>
<span id="cb51-502"><a href="#cb51-502" aria-hidden="true" tabindex="-1"></a>R^2_{adj} = 1 - \Big(\frac{\text{Var(resid)}}{\text{Var}(Y)}\Big) \cdot \frac{n-1}{n-k-1}$$</span>
<span id="cb51-503"><a href="#cb51-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-506"><a href="#cb51-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-507"><a href="#cb51-507" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(danceability <span class="sc">~</span> mode_name <span class="sc">+</span> valence <span class="sc">+</span> energy, <span class="at">data =</span> taylor_album_songs)</span>
<span id="cb51-508"><a href="#cb51-508" aria-hidden="true" tabindex="-1"></a><span class="fu">ar2</span>(m)</span>
<span id="cb51-509"><a href="#cb51-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-510"><a href="#cb51-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-511"><a href="#cb51-511" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix: quick templates (copy‑paste)</span></span>
<span id="cb51-512"><a href="#cb51-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-513"><a href="#cb51-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Model</span></span>
<span id="cb51-514"><a href="#cb51-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-515"><a href="#cb51-515" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-516"><a href="#cb51-516" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> DATA)</span>
<span id="cb51-517"><a href="#cb51-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-518"><a href="#cb51-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-519"><a href="#cb51-519" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-520"><a href="#cb51-520" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-521"><a href="#cb51-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-522"><a href="#cb51-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-523"><a href="#cb51-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple linear regression</span></span>
<span id="cb51-524"><a href="#cb51-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-525"><a href="#cb51-525" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-526"><a href="#cb51-526" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb51-527"><a href="#cb51-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-528"><a href="#cb51-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-529"><a href="#cb51-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-530"><a href="#cb51-530" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-531"><a href="#cb51-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`flipper_length_mm`</span>)</span>
<span id="cb51-532"><a href="#cb51-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-533"><a href="#cb51-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-534"><a href="#cb51-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## SLR: Categorical predictor</span></span>
<span id="cb51-535"><a href="#cb51-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-536"><a href="#cb51-536" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-537"><a href="#cb51-537" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA) </span>
<span id="cb51-538"><a href="#cb51-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-539"><a href="#cb51-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-540"><a href="#cb51-540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-541"><a href="#cb51-541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-542"><a href="#cb51-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`species`</span>)</span>
<span id="cb51-543"><a href="#cb51-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-544"><a href="#cb51-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-545"><a href="#cb51-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## SLR: Categorical predictor (Create Factor)</span></span>
<span id="cb51-546"><a href="#cb51-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-547"><a href="#cb51-547" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-548"><a href="#cb51-548" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="fu">factor</span>(X), <span class="at">data =</span> DATA)   <span class="co"># coerce X to factor</span></span>
<span id="cb51-549"><a href="#cb51-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-550"><a href="#cb51-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-551"><a href="#cb51-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-552"><a href="#cb51-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-553"><a href="#cb51-553" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`species`</span>)</span>
<span id="cb51-554"><a href="#cb51-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-555"><a href="#cb51-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-556"><a href="#cb51-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numerical Statistics by Categories</span></span>
<span id="cb51-557"><a href="#cb51-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-558"><a href="#cb51-558" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-559"><a href="#cb51-559" aria-hidden="true" tabindex="-1"></a><span class="fu">num_by_cat_stats</span>(DATA, NUM, CAT)</span>
<span id="cb51-560"><a href="#cb51-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-561"><a href="#cb51-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-562"><a href="#cb51-562" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DATA`</span>: the data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-563"><a href="#cb51-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`NUM`</span>: the numerical variable you want to summarize (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-564"><a href="#cb51-564" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`CAT`</span>: the categorical variable that defines groups (e.g., <span class="in">`species`</span>)</span>
<span id="cb51-565"><a href="#cb51-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-566"><a href="#cb51-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation</span></span>
<span id="cb51-567"><a href="#cb51-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-568"><a href="#cb51-568" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-569"><a href="#cb51-569" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DATA<span class="sc">$</span>Y, DATA<span class="sc">$</span>X, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb51-570"><a href="#cb51-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-571"><a href="#cb51-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-572"><a href="#cb51-572" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-573"><a href="#cb51-573" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-574"><a href="#cb51-574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`flipper_len`</span>)</span>
<span id="cb51-575"><a href="#cb51-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-576"><a href="#cb51-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-577"><a href="#cb51-577" aria-hidden="true" tabindex="-1"></a><span class="fu">## $R^2$</span></span>
<span id="cb51-578"><a href="#cb51-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-579"><a href="#cb51-579" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-580"><a href="#cb51-580" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb51-581"><a href="#cb51-581" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(m)</span>
<span id="cb51-582"><a href="#cb51-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-583"><a href="#cb51-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-584"><a href="#cb51-584" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-585"><a href="#cb51-585" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-586"><a href="#cb51-586" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`flipper_len`</span>)</span>
<span id="cb51-587"><a href="#cb51-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-588"><a href="#cb51-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-589"><a href="#cb51-589" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple linear regression</span></span>
<span id="cb51-590"><a href="#cb51-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-591"><a href="#cb51-591" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-592"><a href="#cb51-592" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb51-593"><a href="#cb51-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-594"><a href="#cb51-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-595"><a href="#cb51-595" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-596"><a href="#cb51-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-597"><a href="#cb51-597" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X1`, `X2`, ..., `Xp`** → predictor variables (e.g <span class="in">`flipper_len`</span>, <span class="in">`species`</span>)</span>
<span id="cb51-598"><a href="#cb51-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-599"><a href="#cb51-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-600"><a href="#cb51-600" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjusted $R^2$</span></span>
<span id="cb51-601"><a href="#cb51-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-602"><a href="#cb51-602" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-603"><a href="#cb51-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R^2</span></span>
<span id="cb51-604"><a href="#cb51-604" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb51-605"><a href="#cb51-605" aria-hidden="true" tabindex="-1"></a><span class="fu">ar2</span>(m)</span>
<span id="cb51-606"><a href="#cb51-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-607"><a href="#cb51-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-608"><a href="#cb51-608" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-609"><a href="#cb51-609" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-610"><a href="#cb51-610" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X1`, `X2`, ..., `Xp`** → predictor variables (e.g <span class="in">`flipper_len`</span>, <span class="in">`species`</span>)</span>
<span id="cb51-611"><a href="#cb51-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-612"><a href="#cb51-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-613"><a href="#cb51-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction: SLR</span></span>
<span id="cb51-614"><a href="#cb51-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-615"><a href="#cb51-615" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-616"><a href="#cb51-616" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> DATA)</span>
<span id="cb51-617"><a href="#cb51-617" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> VAL)</span>
<span id="cb51-618"><a href="#cb51-618" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span>
<span id="cb51-619"><a href="#cb51-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-620"><a href="#cb51-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-621"><a href="#cb51-621" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-622"><a href="#cb51-622" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-623"><a href="#cb51-623" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X`** → predictor variables (e.g <span class="in">`flipper_len`</span>)</span>
<span id="cb51-624"><a href="#cb51-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-625"><a href="#cb51-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-626"><a href="#cb51-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction: MLR</span></span>
<span id="cb51-627"><a href="#cb51-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-628"><a href="#cb51-628" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb51-629"><a href="#cb51-629" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ... <span class="sc">+</span> Xp, <span class="at">data =</span> DATA)</span>
<span id="cb51-630"><a href="#cb51-630" aria-hidden="true" tabindex="-1"></a>ndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> VAL1, <span class="at">X2 =</span> VAL2, ..., <span class="at">Xp =</span> VALp)</span>
<span id="cb51-631"><a href="#cb51-631" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, <span class="at">newdata =</span> ndf)</span>
<span id="cb51-632"><a href="#cb51-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-633"><a href="#cb51-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-634"><a href="#cb51-634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`DATA`** → your data frame (e.g., <span class="in">`penguins`</span>)</span>
<span id="cb51-635"><a href="#cb51-635" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`Y`** → the outcome variable (e.g., <span class="in">`body_mass`</span>)</span>
<span id="cb51-636"><a href="#cb51-636" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`X1`, `X2`, ..., `Xp`** → predictor variables (e.g <span class="in">`flipper_len`</span>, <span class="in">`species`</span>)</span>
<span id="cb51-637"><a href="#cb51-637" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`VAL1`, `VAL2`, ..., `VALp`** → predictor values (e.g <span class="in">`150`</span>, <span class="in">`"Gentoo"`</span>)</span>
<span id="cb51-638"><a href="#cb51-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-639"><a href="#cb51-639" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scatter Plot</span></span>
<span id="cb51-640"><a href="#cb51-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-641"><a href="#cb51-641" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-642"><a href="#cb51-642" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span> </span>
<span id="cb51-643"><a href="#cb51-643" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb51-644"><a href="#cb51-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-645"><a href="#cb51-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-646"><a href="#cb51-646" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DATA`</span> → the name of your dataset (e.g., <span class="in">`penguins`</span>).</span>
<span id="cb51-647"><a href="#cb51-647" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`VAR1`</span> → a single numerical variable (e.g., <span class="in">`body_mass`</span>).</span>
<span id="cb51-648"><a href="#cb51-648" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`VAR2`</span> → a single numerical variable (e.g., <span class="in">`flipper_len`</span>).</span>
<span id="cb51-649"><a href="#cb51-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-650"><a href="#cb51-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scatter Plot + trend line</span></span>
<span id="cb51-651"><a href="#cb51-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-652"><a href="#cb51-652" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-653"><a href="#cb51-653" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> VAR1, <span class="at">y =</span> VAR2)) <span class="sc">+</span> </span>
<span id="cb51-654"><a href="#cb51-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb51-655"><a href="#cb51-655" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-656"><a href="#cb51-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-657"><a href="#cb51-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-658"><a href="#cb51-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DATA`</span> → the name of your dataset (e.g., <span class="in">`penguins`</span>).</span>
<span id="cb51-659"><a href="#cb51-659" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`VAR1`</span> → a single numerical variable (e.g., <span class="in">`body_mass`</span>).</span>
<span id="cb51-660"><a href="#cb51-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`VAR2`</span> → a single numerical variable (e.g., <span class="in">`flipper_len`</span>).</span>
<span id="cb51-661"><a href="#cb51-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-662"><a href="#cb51-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-663"><a href="#cb51-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Density Plot (Continous vs Categorical)</span></span>
<span id="cb51-664"><a href="#cb51-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-665"><a href="#cb51-665" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-666"><a href="#cb51-666" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">color =</span> CAT)) <span class="sc">+</span> </span>
<span id="cb51-667"><a href="#cb51-667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() </span>
<span id="cb51-668"><a href="#cb51-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-669"><a href="#cb51-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-670"><a href="#cb51-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DATA`</span> → the name of your dataset (e.g., <span class="in">`penguins`</span>).</span>
<span id="cb51-671"><a href="#cb51-671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`NUM`</span> → a single numerical variable (e.g., <span class="in">`body_mass`</span>).</span>
<span id="cb51-672"><a href="#cb51-672" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`CAT`</span> → a single categorical variable (e.g., <span class="in">`species`</span>).</span>
<span id="cb51-673"><a href="#cb51-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-674"><a href="#cb51-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-675"><a href="#cb51-675" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Box Plots (Continous vs Categorical)</span></span>
<span id="cb51-676"><a href="#cb51-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-677"><a href="#cb51-677" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb51-678"><a href="#cb51-678" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DATA, <span class="fu">aes</span>(<span class="at">x =</span> NUM, <span class="at">y =</span> CAT)) <span class="sc">+</span> </span>
<span id="cb51-679"><a href="#cb51-679" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() </span>
<span id="cb51-680"><a href="#cb51-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-681"><a href="#cb51-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-682"><a href="#cb51-682" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DATA`</span> → the name of your dataset (e.g., <span class="in">`penguins`</span>).</span>
<span id="cb51-683"><a href="#cb51-683" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`NUM`</span> → a single numerical variable (e.g., <span class="in">`body_mass`</span>).</span>
<span id="cb51-684"><a href="#cb51-684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`CAT`</span> → a single categorical variable (e.g., <span class="in">`species`</span>).</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>