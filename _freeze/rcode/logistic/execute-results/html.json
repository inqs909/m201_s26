{
  "hash": "2ed0acb8a8dfcf2165882e19679f3ed9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression Models\"\ndescription: |\n  The logistic regression model, interpreting coefficients (odds & odds ratios), fitting\n  models in R, and predicting probabilities.\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    code-tools: true\n    code-fold: false\n    smooth-scroll: true\neditor: source\nimage: img/logistic.png\nexecute:\n  echo: true\n  warning: false\n  message: false\n  error: true\njupyter: r\nknitr:\n  opts_chunk:\n    comment: \"#>\"\n---\n\n\n\n\n# Google Colab\n\nCopy the following code and put it in a code cell in Google Colab. Only do this if you are using a completely new notebook.\n\n```r\n# This code will load the R packages we will use\ninstall.packages(c(\"rcistats\"),\n                 repos = c(\"https://inqs909.r-universe.dev\", \n                           \"https://cloud.r-project.org\"))\nlibrary(tidyverse)\nlibrary(csucistats)\nlibrary(MASS)\n\n\n# Uncomment and run for themes\n# csucistats::install_themes()\n# library(ThemePark)\n# library(ggthemes)\n\n# Outcome: 1 = died from Melanoma, 0 = did not\nMelanoma$dead <- ifelse(Melanoma$status == 1, 1, 0)\n```\n\n# Data\n\n## Melanoma\n\nMelanoma is a type of skin cancer arising from melanin‑producing cells. It is dangerous because it can metastasize to other parts of the body.\n\n## Outcome of interest\n\nWe want to understand **how predictors affect survival** during a study period. We therefore code a **binary outcome** `dead`.\n\n## Data\n\nWe use `MASS::Melanoma` with:- `dead` (1 = died of Melanoma, 0 = otherwise),- `sex` (1 = male, 0 = female),- `age` (years),- `thickness` (tumour thickness in mm),- `ulcer` (1 = present, 0 = absent).\n\n## Plot\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(Melanoma, aes(thickness, dead)) +\n  geom_point(alpha = 0.7) +\n  labs(x = \"Tumour thickness (mm)\", y = \"Dead (1=yes, 0=no)\") +\n  stat_smooth(method = \"glm\",\n              se = F,\n              method.args = list(family = \"binomial\"),\n              color = \"blue\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n# Logistic regression in R\n\n**Logistic regression** models the relationship between predictors and a **binary** outcome by making the **log‑odds** a linear function of the predictors.\n\n\n## Fitting Model\n\n**Template:**\n\n```r\n# Logistic regression (binomial GLM)\nglm(Y ~ X1 + X2 + ... + Xp,\n    data = DATA,\n    family = binomial())\n```\n\n**Example (Melanoma):**\n\nModel `dead` by `sex`, `age`, `thickness`, and `ulcer`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm(dead ~ sex + age + thickness + ulcer,\n    data = Melanoma,\n    family = binomial())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:  glm(formula = dead ~ sex + age + thickness + ulcer, family = binomial(), \n#>     data = Melanoma)\n#> \n#> Coefficients:\n#> (Intercept)          sex          age    thickness        ulcer  \n#>    -2.39860      0.40767      0.00402      0.11253      1.31314  \n#> \n#> Degrees of Freedom: 204 Total (i.e. Null);  200 Residual\n#> Null Deviance:\t    242.4 \n#> Residual Deviance: 210.3 \tAIC: 220.3\n```\n\n\n:::\n:::\n\n\nThe fitted logit equation can be written generically as\n\n\n## Odds ratios (exponentiated coefficients)\n\n**Template:**\n\n```r\n# Logistic regression (binomial GLM)\nm <- glm(Y ~ X1 + X2 + ... + Xp,\n         data = DATA,\n         family = binomial())\nexp(coef(m))\n```\n\n**Example:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- glm(dead ~ sex + age + thickness + ulcer,\n    data = Melanoma,\n    family = binomial())\nexp(coef(m))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> (Intercept)         sex         age   thickness       ulcer \n#>  0.09084468  1.50331052  1.00402853  1.11910869  3.71781566\n```\n\n\n:::\n:::\n\n\n\n# Prediction with models\n\n## Model\n\n$$\n\\hat P(Y=1) = \\frac{e^{\\hat\\beta_0 + \\hat\\beta_1 X_1 + \\cdots + \\hat\\beta_p X_p}}{1 + e^{\\hat\\beta_0 + \\hat\\beta_1 X_1 + \\cdots + \\hat\\beta_p X_p}}.\n$$\n\n**Template:**\n\n```r\nxglm <- glm(Y ~ X1 + X2 + ... + Xp,\n            data = DATA,\n            family = binomial())\n\nnew_df <- data.frame(X1 = VAL1, X2 = VAL2, ..., Xp = VALp)\npredict(xglm, newdata = new_df, type = \"response\")  # probabilities\n```\n\n**Examples (Melanoma):**\n\n0) **Fit a model with gender, age, thickness, and ulcer present**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxglm <- glm(dead ~ sex + age + thickness + ulcer,\n    data = Melanoma,\n    family = binomial())\n```\n:::\n\n\n\n1) **Male, age 75, thickness 2.9, ulcer present**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew1 <- data.frame(sex = 1, age = 75, thickness = 2.9, ulcer = 1)\npredict(xglm, new1, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.4875223\n```\n\n\n:::\n:::\n\n\n2) **Male, age 75, thickness 2.9, ulcer absent**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew2 <- data.frame(sex = 1, age = 75, thickness = 2.9, ulcer = 0)\npredict(xglm, new2, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.2037438\n```\n\n\n:::\n:::\n\n\n\n3) **Female, thickness 2.9, ulcer present — compare ages 55 vs 75**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew3 <- tibble(sex = 0, age = c(55, 75), thickness = 2.9, ulcer = 1)\npred3 <- predict(xglm, new3, type = \"response\")\ntibble(age = new3$age, probability = scales::percent(pred3, accuracy = 0.1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 2 × 2\n#>     age probability\n#>   <dbl> <chr>      \n#> 1    55 36.9%      \n#> 2    75 38.8%\n```\n\n\n:::\n:::\n\n\n# Appendix: quick reference (copy‑paste)\n\n## Simple Logistic Regression\n\n```r\n# Fit\nglm(Y ~ X, data = DATA, family = binomial())\n```\n\n-   **`DATA`** → your data frame (e.g., `Melanoma`)\n-   **`Y`** → the outcome variable (e.g., `dead`)\n-   **`X`** → predictor variables (e.g `thickness`)\n\n## Logistic Regression\n\n```r\n# Fit\nglm(Y ~ X1 + X2 + ... + Xp, data = DATA, family = binomial())\n```\n\n-   **`DATA`** → your data frame (e.g., `Melanoma`)\n-   **`Y`** → the outcome variable (e.g., `dead`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `age`, `thickness`)\n\n\n## Odds Ratio\n\n```r\nm <- glm(Y ~ X1 + X2 + ... + Xp, data = DATA, family = binomial())\n\n# Odds Ratio\nexp(coef(m))\n```\n\n-   **`DATA`** → your data frame (e.g., `Melanoma`)\n-   **`Y`** → the outcome variable (e.g., `dead`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `age`, `thickness`)\n\n\n## Predict Probabilities\n\n```r\nm <- glm(Y ~ X1 + X2 + ... + Xp, data = DATA, family = binomial())\n# Predict probabilities\nnew_df <- data.frame(X1 = VAL1, X2 = VAL2, ...,  Xp = VALp)\npredict(m, newdata = new_df, type = \"response\")\n```\n\n-   **`DATA`** → your data frame (e.g., `Melanoma`)\n-   **`Y`** → the outcome variable (e.g., `dead`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `age`, `thickness`)\n-   **`VAL1`, `VAL2`, ..., `VALp`** → predictor values (e.g `55`, `2.8`)\n",
    "supporting": [
      "logistic_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}