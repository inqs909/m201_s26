{
  "hash": "3de44da7aca3dcee2e0d59d8476d91ee",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear Regression Models\"\ndescription: \"Explaining variation, simple & multiple linear models, categorical predictors, correlation, and prediction\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    code-tools: true\n    code-fold: false\n    smooth-scroll: true\n    axe: \n      output: document\neditor: source\nimage: img/linear.png\nexecute:\n  echo: true\n  warning: false\n  message: false\n  error: true\njupyter: r\nknitr:\n  opts_chunk:\n    comment: \"#>\"\n    results: asis\n---\n\n\n# Setup\n\n\n\n## Google Colab\n\nCopy the following code and put it in a code cell in Google Colab. Only do this if you are using a completely new notebook.\n\n``` r\n# This code will load the R packages we will use\ninstall.packages(c(\"rcistats\", \"taylor\",,\n                 repos = c(\"https://inqs909.r-universe.dev\", \n                           \"https://cloud.r-project.org\")))\n\n\nlibrary(rcistats)\nlibrary(tidyverse)\nlibrary(taylor)\n```\n\n## Using the templates: what to change\n\n-   **`DATA`** → your data frame/tibble (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass_g`)\n-   **`X`, `X1`, `X2`, ..., `Xp`** → predictor variables (e.g `flipper_length_mm`, `species`)\n-   For categorical predictors: ensure the predictor is a **factor** (use `factor(X)` if needed).\n\n# Visualizing Variables\n\n## Scatter Plot (Continuous vs Continuous)\n\nA **scatter plot** reveals association, trend direction, and form.\n\n**Template:**\n\n```r\nggplot(DATA, aes(x = VAR1, y = VAR2)) +\n  geom_point()\n```\n\n**Example:**\n\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_len, y = body_mass)) +\n  geom_point()\n```\n\n![](regression_files/figure-html/unnamed-chunk-1-1.png){fig-alt='A scatter plot that shows the relationship between flipper length\nand body mass. The data points show a positive relationship, \nand possibly two groups. ' width=672}\n\n\n## Multi Densigy Plot (Continuous vs Categorical)\n\nA density plot is a way to visualize the distribution of a continuous variable — it shows where data values are concentrated (dense) and where they are sparse.\n\n\n::: panel-tabset\n\n### Color\n\n**Template:**\n\n```r\nggplot(DATA, aes(x = NUM, color = CAT)) +\n  geom_density()\n```\n\n**Example:**\n\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_len, color = species)) +\n  geom_density()\n```\n\n![](regression_files/figure-html/unnamed-chunk-2-1.png){fig-alt='Kernel density plot showing the distribution of penguin flipper lengths\nby species. Adelie penguins have shorter flippers centered around 190 mm,\nChinstrap penguins are intermediate around 195 mm, and Gentoo penguins\nhave much longer flippers centered around 215–220 mm, \nwith little overlap between Gentoo and the other species.' width=672}\n\n### Fill\n\n**Template:**\n\n```r\nggplot(DATA, aes(x = NUM, fill = CAT)) +\n  geom_density()\n```\n\n**Example:**\n\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_len, fill = species)) +\n  geom_density()\n```\n\n![](regression_files/figure-html/unnamed-chunk-3-1.png){fig-alt='Filled kernel density plot showing the distribution of penguin \nflipper lengths by species. Adelie penguins have shorter flippers\ncentered around 190 mm, Chinstrap penguins are intermediate \naround 195 mm, and Gentoo penguins have much longer \nflippers centered around 215–220 mm, \nwith little overlap between Gentoo and the other species.' width=672}\n\n### Group\n\n**Template:**\n\n```r\nggplot(DATA, aes(x = NUM, group = CAT)) +\n  geom_density()\n```\n\n**Example:**\n\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_len, group = species)) +\n  geom_density()\n```\n\n![](regression_files/figure-html/unnamed-chunk-4-1.png){fig-alt='Kernel density plot showing the distribution of penguin flipper lengths\nby species. Adelie penguins have shorter flippers centered around 190 mm,\nChinstrap penguins are intermediate around 195 mm, and Gentoo penguins\nhave much longer flippers centered around 215–220 mm, \nwith little overlap between Gentoo and the other species.\n' width=672}\n\n:::\n\n## Multi Box Plot (Continuous vs Categorical)\n\nA **box plot** summarizes median, quartiles, and potential outliers.\n\n**Template:**\n\n```r\nggplot(DATA, aes(x = NUM, y = CAT)) +\n  geom_boxplot()\n```\n\n**Example:**\n\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_len, y = species)) +\n  geom_boxplot()\n```\n\n![](regression_files/figure-html/unnamed-chunk-5-1.png){fig-alt='Horizontal boxplots of penguin flipper lengths (mm) by species.\nAdelie penguins have the shortest flippers with a median around \n190 mm and a few outliers; Chinstrap penguins are intermediate with \na median near 195 mm; and Gentoo penguins have the longest flippers \nwith a median around 215–220 mm. The distributions show clear \nseparation between Gentoo and the other species.' width=672}\n\n\n\n# Modeling Relationships\n\n## Explaining variation\n\nThis is the process of trying to **reduce unexplained variation** in an outcome by using informative predictors — think *getting it less wrong* with an educated guess.\n\n\n```{.r .cell-code}\nggplot(penguins, aes(body_mass)) +\n  geom_density()\n```\n\n![](regression_files/figure-html/fig-plot-1-1.png){#fig-plot-1 fig-alt='Kernel density plot of penguin body mass (grams). \nThe distribution peaks around 3,600–3,800 grams and gradually \ntapers toward higher body masses, with a long right tail \nextending beyond 6,000 grams.\n' width=672}\n\nIf we know some information, we can get less wrong over time.\n\n\n```{.r .cell-code}\n# Same variable, grouped by a category (species)\nggplot(penguins, aes(body_mass, fill = species)) +\n  geom_density(alpha = .5)\n```\n\n![](regression_files/figure-html/unnamed-chunk-6-1.png){fig-alt='Filled kernel density plot of penguin body mass (grams) by species. \nAdelie penguins (red) and Chinstrap penguins (green) have lower \nbody masses, with overlapping distributions centered around 3,500–4,000 \ngrams, while Gentoo penguins (blue) are substantially heavier, \nwith a distribution centered around 4,800–5,500 grams and \nlittle overlap with the other species.' width=672}\n\n## A simple model (intercept-only)\n\nWe believe the outcome ($Y$) is generated by an unknown data generated process ($DGP_1$): $Y \\sim DGP_1$. A minimal model says all outcomes are generated from a number (labeled as $\\beta_0$) plus or minus some error ($\\varepsilon$):\\\n$$ Y = \\beta_0 + \\varepsilon $$\n\nThis is known as a simple model and the errors are simulated by a different DGP $\\varepsilon \\sim DGP_2$. The simple model is unknown, so we construct and estimated simple model for our best guess on how the data is generated:\n\n$$\n\\hat Y = \\hat\\beta_0\n$$\n\nThe carats above the letters are known as hats, which means best guess.\n\n::: callout-tip\n\n**Observed vs. estimated:**\n\n-   Observed $Y = \\beta_0 + \\varepsilon$\n-   Estimated $\\hat Y = \\hat\\beta_0$\n\n:::\n\n### Fitting Simple Model\n\n**Template:**\n\n``` r\nlm(Y ~ 1, data = DATA)\n```\n\n-   **`DATA`** → your data (e.g., `penguins`).\\\n-   **`Y`** → the outcome variable (e.g., `body_mass_g`).\n\n**Example:**\n\n\n```{.r .cell-code}\n# Fit the null (intercept-only) model\nm0 <- lm(body_mass ~ 1, data = penguins)\nm0\n```\n\n\nCall:\nlm(formula = body_mass ~ 1, data = penguins)\n\nCoefficients:\n(Intercept)  \n       4207  \n\n## Linear regression model with one predictor\n\n**Model form:**\n\n$$\nY = \\beta_0 + \\beta_1 X + \\varepsilon, \\quad \\hat Y = \\hat\\beta_0 + \\hat\\beta_1 X.\n$$\n\n\n```{.r .cell-code}\n# Scatter plot\nggplot(penguins, aes(flipper_len, body_mass)) +\n  geom_point()\n```\n\n![](regression_files/figure-html/unnamed-chunk-8-1.png){fig-alt='A scatter plot that shows the relationship between flipper length\nand body mass. The data points show a positive relationship, \nand possibly two groups. ' width=672}\n\n\n```{.r .cell-code}\n# Add a least-squares line\nggplot(penguins, aes(flipper_len, body_mass)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = FALSE)\n```\n\n![](regression_files/figure-html/unnamed-chunk-9-1.png){fig-alt='A scatter plot that shows the relationship between flipper length\nand body mass. The data points show a positive relationship, \nand possibly two groups. There is a line going between the \npoints showing a positive line.' width=672}\n\n\n```{.r .cell-code}\n# Fit the model\nm1 <- lm(body_mass ~ flipper_len, data = penguins)\nm1\n```\n\n\nCall:\nlm(formula = body_mass ~ flipper_len, data = penguins)\n\nCoefficients:\n(Intercept)  flipper_len  \n   -5872.09        50.15  \n\n**Template:**\n\n``` r\nlm(Y ~ X, data = DATA)\n```\n\n# Categorical predictors (dummy variables)\n\nWhen we use a **categorical predictor** in a regression, R needs to convert the categories into numbers. This is done using **dummy variables** (also called indicator variables).\n\n## General idea\n\n-   Suppose we have a categorical variable with **C categories**.\\\n-   We create **C − 1 dummy variables**, each taking value:\n    -   `1` if the observation belongs to that category\\\n    -   `0` otherwise\\\n-   The category without a dummy variable becomes the **reference (baseline)** group.\n\n**Example: Penguin species:**\n\nThe `species` variable has 3 categories: **Adelie, Chinstrap, Gentoo**.\n\nWe create two dummy variables:\n\n-   $D_1$: 1 if Chinstrap, 0 otherwise\\\n-   $D_2$: 1 if Gentoo, 0 otherwise\\\n-   Adelie is the reference (when both $D_1 = 0, D_2 = 0$)\n\n| Species   | $D_1$ (Chinstrap) | $D_2$ (Gentoo) |\n|-----------|-------------------|----------------|\n| Adelie    | 0                 | 0              |\n| Chinstrap | 1                 | 0              |\n| Gentoo    | 0                 | 1              |\n\n## Regression model with dummy variables\n\nIf we model penguin body mass ($Y$) with species:\n\n$$\n\\hat Y_i = \\beta_0 + \\beta_1 D_{1i} + \\beta_2 D_{2i}\n$$\n\n-   $\\beta_0$: mean of Adelie (reference group)\\\n-   $\\beta_1$: difference in mean body mass between Chinstrap and Adelie\\\n-   $\\beta_2$: difference in mean body mass between Gentoo and Adelie\n\nPredictions:\\\n- Adelie: $\\hat Y = \\beta_0$\\\n- Chinstrap: $\\hat Y = \\beta_0 + \\beta_1$\\\n- Gentoo: $\\hat Y = \\beta_0 + \\beta_2$\n\n## R Implementation\n\nR automatically creates dummy variables when you use a factor in `lm()`.\\\nThe first level of the factor is used as the **reference group** (by default).\n\n\n```{.r .cell-code}\n# Fit model with species (factor) as predictor\nm <- lm(body_mass ~ species, data = penguins)\nsummary(m)\n```\n\n\nCall:\nlm(formula = body_mass ~ species, data = penguins)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1142.44  -342.44   -33.09   307.56  1207.56 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       3706.16      38.14  97.184   <2e-16 ***\nspeciesChinstrap    26.92      67.65   0.398    0.691    \nspeciesGentoo     1386.27      56.91  24.359   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 460.8 on 330 degrees of freedom\nMultiple R-squared:  0.6745,\tAdjusted R-squared:  0.6725 \nF-statistic: 341.9 on 2 and 330 DF,  p-value: < 2.2e-16\n\n**Templates:**\n\n``` r\nlm(Y ~ X, data = DATA)           # if X is already a factor\nlm(Y ~ factor(X), data = DATA)   # force X to be treated as factor\n```\n\n## Group Statistics\n\nThe function `num_by_cat_stats()` quickly computes **descriptive statistics of a numerical variable grouped by a categorical variable**.\n\n**Template:**\n\n``` r\nnum_by_cat_stats(DATA, NUM, CAT)\n```\n\n-   `DATA`: the data frame (e.g., `penguins`)\n-   `NUM`: the numerical variable you want to summarize (e.g., `body_mass_g`)\n-   `CAT`: the categorical variable that defines groups (e.g., `species`)\n\n**Example:**\n\n\n```{.r .cell-code}\nnum_by_cat_stats(penguins, body_mass, species)\n```\n\n  Categories  min    q25     mean median  q75  max      sd      var   iqr\n1     Adelie 2850 3362.5 3706.164   3700 4000 4775 458.620 210332.4 637.5\n2  Chinstrap 2700 3487.5 3733.088   3700 3950 4800 384.335 147713.5 462.5\n3     Gentoo 3950 4700.0 5092.437   5050 5500 6300 501.476 251478.3 800.0\n  missing\n1       0\n2       0\n3       0\n\n# Strength & correlation\n\nCorrelation (two numerical variables): $-1 \\le r \\le 1$. For simple linear regression, $R^2 = r^2$.\n\n\n```{.r .cell-code}\ncor(penguins$body_mass, penguins$flipper_len)\n```\n\n[1] 0.8729789\n\n\n```{.r .cell-code}\n# R^2 helper\nr2(lm(body_mass ~ flipper_leng, data = penguins))\n```\n\n```\n#> Error:\n#> ! object 'flipper_leng' not found\n```\n\n**Template:**\n\n```r\n# Correlation\ncor(DATA$Y, DATA$X)\n\n## R-Squared\nxlm <- lm(Y ~ X, data = DATA); \nr2(xlm)\n```\n\n# Prediction\n\nModel: $\\hat Y = \\hat\\beta_0 + \\hat\\beta_1 X$. Supply new X to get a prediction $\\hat Y$.\n\n**Template:**\n\n``` r\nm <- lm(Y ~ X, data = DATA)\nndf <- data.frame(X = VAL)\npredict(m, newdata = ndf)\n```\n\n**Examples:**\n\n\n```{.r .cell-code}\nxlm1 <- lm(body_mass ~ species, data = penguins)\npredict(xlm1, newdata = data.frame(species = \"Gentoo\"))\n```\n\n       1 \n5092.437 \n\n\n```{.r .cell-code}\nxlm2 <- lm(body_mass ~ flipper_len, data = penguins)\npredict(xlm2, newdata = data.frame(flipper_len = 190))\n```\n\n       1 \n3657.028 \n\n# Multiple linear regression (MLR)\n\nModel: $Y = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p + \\varepsilon$\n\n**Template:**\n\n``` r\nlm(Y ~ X1 + X2 + ... + Xp, data = DATA)\n```\n\n**Example: danceability \\~ mode_name + valence + energy**\n\n\n```{.r .cell-code}\n# Example: danceability ~ mode_name + valence + energy\nlm(danceability ~ mode_name + valence + energy, data = taylor_album_songs)\n```\n\n\nCall:\nlm(formula = danceability ~ mode_name + valence + energy, data = taylor_album_songs)\n\nCoefficients:\n   (Intercept)  mode_nameminor         valence          energy  \n       0.53816         0.08386         0.17554        -0.05944  \n\n## Adjusted $R^2$\n\n$$R^2 = 1 - \\frac{\\text{Var(resid)}}{\\text{Var}(Y)}, \\quad\nR^2_{adj} = 1 - \\Big(\\frac{\\text{Var(resid)}}{\\text{Var}(Y)}\\Big) \\cdot \\frac{n-1}{n-k-1}$$\n\n\n```{.r .cell-code}\nm <- lm(danceability ~ mode_name + valence + energy, data = taylor_album_songs)\nar2(m)\n```\n\n[1] 0.09148268\n\n# Appendix: quick templates (copy‑paste)\n\n## Simple Model\n\n```r\nlm(Y ~ 1, data = DATA)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n\n\n## Simple linear regression\n\n```r\nlm(Y ~ X, data = DATA)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `flipper_length_mm`)\n\n\n## SLR: Categorical predictor\n\n```r\nlm(Y ~ X, data = DATA) \n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `species`)\n\n\n## SLR: Categorical predictor (Create Factor)\n\n```r\nlm(Y ~ factor(X), data = DATA)   # coerce X to factor\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `species`)\n\n\n## Numerical Statistics by Categories\n\n```r\nnum_by_cat_stats(DATA, NUM, CAT)\n```\n\n-   `DATA`: the data frame (e.g., `penguins`)\n-   `NUM`: the numerical variable you want to summarize (e.g., `body_mass`)\n-   `CAT`: the categorical variable that defines groups (e.g., `species`)\n\n## Correlation\n\n``` r\ncor(DATA$Y, DATA$X, use = \"complete.obs\")\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `flipper_len`)\n\n\n## $R^2$\n\n``` r\nm <- lm(Y ~ X, data = DATA)\nr2(m)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `flipper_len`)\n\n\n## Multiple linear regression\n\n``` r\nlm(Y ~ X1 + X2 + ... + Xp, data = DATA)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `flipper_len`, `species`)\n\n\n## Adjusted $R^2$\n\n``` r\n# Adjusted R^2\nm <- lm(Y ~ X1 + X2 + ... + Xp, data = DATA)\nar2(m)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `flipper_len`, `species`)\n\n\n## Prediction: SLR\n\n``` r\nm <- lm(Y ~ X, data = DATA)\nndf <- data.frame(X = VAL)\npredict(m, newdata = ndf)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X`** → predictor variables (e.g `flipper_len`)\n\n\n## Prediction: MLR\n\n``` r\nm <- lm(Y ~ X1 + X2 + ... + Xp, data = DATA)\nndf <- data.frame(X1 = VAL1, X2 = VAL2, ..., Xp = VALp)\npredict(m, newdata = ndf)\n```\n\n-   **`DATA`** → your data frame (e.g., `penguins`)\n-   **`Y`** → the outcome variable (e.g., `body_mass`)\n-   **`X1`, `X2`, ..., `Xp`** → predictor variables (e.g `flipper_len`, `species`)\n-   **`VAL1`, `VAL2`, ..., `VALp`** → predictor values (e.g `150`, `\"Gentoo\"`)\n\n## Scatter Plot\n\n```r\nggplot(DATA, aes(x = VAR1, y = VAR2)) + \n    geom_point()\n```\n\n- `DATA` → the name of your dataset (e.g., `penguins`).\n- `VAR1` → a single numerical variable (e.g., `body_mass`).\n- `VAR2` → a single numerical variable (e.g., `flipper_len`).\n\n## Scatter Plot + trend line\n\n```r\nggplot(DATA, aes(x = VAR1, y = VAR2)) + \n    geom_point() + \n    geom_smooth(method = \"lm\", se = TRUE)\n```\n\n- `DATA` → the name of your dataset (e.g., `penguins`).\n- `VAR1` → a single numerical variable (e.g., `body_mass`).\n- `VAR2` → a single numerical variable (e.g., `flipper_len`).\n\n\n## Multiple Density Plot (Continous vs Categorical)\n\n```r\nggplot(DATA, aes(x = NUM, color = CAT)) + \n    geom_density() \n```\n\n- `DATA` → the name of your dataset (e.g., `penguins`).\n- `NUM` → a single numerical variable (e.g., `body_mass`).\n- `CAT` → a single categorical variable (e.g., `species`).\n\n\n## Multiple Box Plots (Continous vs Categorical)\n\n```r\nggplot(DATA, aes(x = NUM, y = CAT)) + \n    geom_boxplot() \n```\n\n- `DATA` → the name of your dataset (e.g., `penguins`).\n- `NUM` → a single numerical variable (e.g., `body_mass`).\n- `CAT` → a single categorical variable (e.g., `species`).\n\n",
    "supporting": [
      "regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}