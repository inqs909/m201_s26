{
  "hash": "b467fac672dc2bafc18f355b906a5d5e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Group <br> Regression\"\ndescription: |\n  Discuss using categorical predictor variables.\n\nformat:\n  revealjs:\n    width: 1200\n    scrollable: true\n    sc-sb-title: true\n    footer: m201.inqs.info/lectures/7\n    theme: [default, styles.scss]\n    navigation-mode: vertical\n    controls-layout: edges\n    controls-tutorial: true\n    slide-number: true\n    pointer:\n      pointerSize: 32\n    incremental: false \n    chalkboard:\n      theme: whiteboard\n      chalk-width: 4\nknitr:\n  opts_chunk: \n    echo: true\n    eval: true\n    message: false\n    code-fold: true\n    warnings: false\n    comment: \"#>\" \n    \nrevealjs-plugins:\n  - pointer\n  - verticator\n  \nfilters: \n  - reveal-header\n  - code-fullscreen\n  - reveal-auto-agenda\n\neditor: source\n---\n\n## R Packages\n\n\n\n-   rcistats\n-   tidyverse\n\n## Palmer Penguins Data\n\n::: {.columns}\n::: {.column}\n\n### Variables of Interest\n\n- `species`: Penguin species\n- `body_mass`: Body mass in [grams](https://en.wikipedia.org/wiki/Gram)\n\n:::\n::: {.column}\n![Artwork by @allison_horst](img/penguins.png){fig-alt=\"An image of several penguins in Antartica.\"}\n\n:::\n::: \n\n## Heart Disease Data\n\n::: {.columns}\n::: {.column}\n\n### Variables of Interest\n\n- `thal`: Thallium stress test result\n- `disease`: Indicating if they have heart disease\n\n:::\n::: {.column}\n![](img/heart_df.png){fig-alt=\"An image of a graph and a heart.\"}\n:::\n:::\n\n\n# Modeling Relationships\n\n## Explaining Continuous Variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(penguins, aes(body_mass)) +\n  geom_density() \n```\n\n::: {.cell-output-display}\n![](7_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n## Linear: Categorical Variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(penguins, aes(body_mass, fill = species)) +\n  geom_density(alpha = .5)\n```\n\n::: {.cell-output-display}\n![](7_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n\n## Explainging Binary Variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nheart_disease |> \n  ggplot(aes(disease)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](7_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n\n## Logistic: Categorical Variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nheart_disease |> \n  ggplot(aes(disease, fill = thal)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](7_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n# Group Statistics\n\n## Group Statistics\n\nWe can use statistics to explain a variable by the categories.\n\n::: fragment\nCompute statistics for each group.\n:::\n\n\n## Continuous Data\n\n```r\nnum_by_cat_stats(DATA, NUM, CAT)\n```\n\n- `NUM`: Name of the numerical variable\n- `CAT`: Name of the categorical variable\n- `DATA`: Name of the data frame\n\n\n\n## Continous Data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nnum_by_cat_stats(penguins, body_mass, species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>   Categories  min    q25     mean median  q75  max      sd      var   iqr\n#> 1     Adelie 2850 3362.5 3706.164   3700 4000 4775 458.620 210332.4 637.5\n#> 2  Chinstrap 2700 3487.5 3733.088   3700 3950 4800 384.335 147713.5 462.5\n#> 3     Gentoo 3950 4700.0 5092.437   5050 5500 6300 501.476 251478.3 800.0\n#>   missing\n#> 1       0\n#> 2       0\n#> 3       0\n```\n\n\n:::\n:::\n\n\n\n## Continuous Data\n\n```r\ncat_stats(DATA$Y, DATA$X, prop = \"row\")\n```\n\nOR\n\n```r\ncat_stats(DATA$X, DATA$Y, prop = \"col\")\n```\n\n\n- `Y`: Name of the outcome variable\n- `X`: Name of the categorical variable\n- `DATA`: Name of the data frame\n\n## Binary Data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\ncat_stats(heart_disease$disease, heart_disease$thal, prop = \"row\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $frequency\n#>      \n#>       Normal Fixed Defect Reversible Defect\n#>   no     127            6                27\n#>   yes     37           12                88\n#> \n#> $row_prop\n#>      \n#>       Normal Fixed Defect Reversible Defect\n#>   no  0.7938       0.0375            0.1688\n#>   yes 0.2701       0.0876            0.6423\n```\n\n\n:::\n:::\n\n\n\n# Group Models\n\n## G/LM with Categorical Variables\n\nA line is normally used to model 2 continuous variables.\n\n::: fragment\nHowever, the predictor variable $X$ can be restricted to a set a **dummy** variables that can symbolize categories.\n:::\n\n::: fragment\nA category from $X$ will be used as a reference for a model.\n:::\n\n## LM Example\n\n$$\nbody\\_mass = \\beta_0 + \\boldsymbol \\beta (species)\n$$\n\n\n::: fragment\n$$\nbody\\_mass = \\beta_0 + \\beta_1 (Chinstrap) + \\beta_2 (Gentoo)\n$$\n:::\n\n::: fragment\n$Chinstrap$ and $Gentoo$ are both dummy variables that will reference Adelie\n:::\n\n## GLM Example\n\n$$\nlo(disease) = \\beta_0 + \\boldsymbol \\beta (thal)\n$$\n\n\n::: fragment\n$$\nlo(disease) = \\beta_0 + \\beta_1 (Fixed) + \\beta_2 (Reversible)\n$$\n:::\n\n::: fragment\n$Fixed$ and $Reversible$ defects are both dummy variables that will reference Normal\n:::\n\n## Dummy Variables\n\nTo fit a model with categorical variables, we must utilize dummy (binary) variables that indicate which category is being referenced. We use $C-1$ dummy variables where $C$ indicates the number of categories. When coded correctly, each category will be represented by a combination of dummy variables.\n\n\n## Dummy Variables\n\nBinary variables are variable that can only take on the value 0 or 1.\n\n$$\nD_i = \\left\\{\n\\begin{array}{cc}\n1 & Category\\\\\n0 & Other\n\\end{array}\n\\right.\n$$\n\n\n## Example\n\nIf we have 4 categories, we will need 3 dummy variables:\n\n|         | Cat 1 | Cat 2 | Cat 3 | Cat 4 |\n|---------|-------|-------|-------|-------|\n| Dummy 1 | 1     | 0     | 0     | 0     |\n| Dummy 2 | 0     | 1     | 0     | 0     |\n| Dummy 2 | 0     | 0     | 1     | 0     |\n\n\n## Species Dummy Variables\n\n| DUMMY | Chinstrap | Gentoo | Adelie (Reference) |\n|-------|-------|-------|-------|\n| $Chinstrap$ | 1     | 0     | 0     |\n| $Gentoo$ | 0     | 1     | 0     |\n\n## Thal Dummy Variables\n\n| DUMMY  | Fixed Defect | Reversible Defect | Normal (Reference) |\n|---------|-------|-------|-------|\n| $Fixed$ | 1     | 0     | 0     |\n| $Reversible$ | 0     | 1     | 0     |\n\n## LM: Penguins\n\n$$\nbody\\_mass = \\hat \\beta_0 + \\hat\\beta_1 (Chinstrap) + \\hat\\beta_2 (Gentoo)\n$$\n\n::: fragment\n$\\hat \\beta_1$ indicates how body mass changes from Adelie to Chinstrap.\n:::\n\n::: fragment\n$\\hat \\beta_2$ indicates how body mass changes from Adelie to Gentoo.\n:::\n\n::: fragment\n$\\hat \\beta_0$ represents the baseline level, in this case the body mass of Adelie.\n:::\n\n## GLM: Penguins\n\n$$\nlo(disease) = \\hat \\beta_0 + \\hat\\beta_1 (Fixed) + \\hat\\beta_2 (Reversible)\n$$\n\n::: fragment\n$\\hat \\beta_1$ indicates how $lo(disease)$ changes from Normal to Fixed.\n:::\n\n::: fragment\n$\\hat \\beta_2$ indicates how $lo(disease)$ changes from Normal to Reversible.\n:::\n\n::: fragment\n$\\hat \\beta_0$ represents the baseline level, in this case the $lo(disease)$ of Normal.\n:::\n\n## Interepreting $\\beta$\n\nInterpreting $\\beta$ for categorical variables are different from continuous (numeric) variables. Interpreting $\\beta$s only allow us to make comparisons between the dummy indicator category and the reference category\n\n## LM: Interpreting $\\beta$\n\n::: {.columns}\n::: {.column}\n\n$$\n\\hat Y = \\hat \\beta_0 + \\hat\\beta_1 D\n$$\n\n:::\n::: {.column}\n\n$$\nD = \\left\\{\n\\begin{array}{cc}\n1 & CAT\\\\\n0 & REF\n\\end{array}\n\\right.\n$$\n\n:::\n::: \n\nOn average, CAT1 has a larger/smaller Y than REF by about $\\beta_1$.\n\n## GLM: Interpreting $\\beta$\n\n::: {.columns}\n::: {.column}\n\n$$\nlo(Y) = \\hat \\beta_0 + \\hat\\beta_1 D\n$$\n\n:::\n::: {.column}\n\n$$\nD = \\left\\{\n\\begin{array}{cc}\n1 & CAT\\\\\n0 & REF\n\\end{array}\n\\right.\n$$\n\n:::\n::: \n\nThe odds of having Y is $e^{\\beta_1}$ times higher/lower for CAT than Ref. \n\n\n# Group Models in R\n\n\n## Fitting an LM in R\n\n```r\nxlm <- lm(Y ~ X, data = DATA)\nxlm\n```\n\n- `X`: Name Predictor Variable of Interest in data frame `DATA`, must be a factor variable\n- `Y`: Name Outcome Variable of Interest in data frame `DATA`\n- `DATA`: Name of the data frame\n\n## Fitting an GLM in R\n\n```r\nxglm <- glm(Y ~ X, data = DATA, family = binomial())\nxglm\n```\n\n- `X`: Name Predictor Variable of Interest in data frame `DATA`, must be a factor variable\n- `Y`: Name Outcome Variable of Interest in data frame `DATA`\n- `DATA`: Name of the data frame\n\n\n## X not a Factor\n\n```r\nxlm <- lm(Y ~ factor(X), data = DATA)\n```\n\nOR\n\n```r\nxglm <- glm(Y ~ factor(X), data = DATA, family = binomial())\n```\n\n\n- `X`: Name Predictor Variable of Interest in data frame `DATA`, not a factor variable\n- `Y`: Name Outcome Variable of Interest in data frame `DATA`\n- `DATA`: Name of the data frame\n\n\n# LM Example\n\n## Example\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxlm <- lm(body_mass ~ species, penguins)\nxlm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:\n#> lm(formula = body_mass ~ species, data = penguins)\n#> \n#> Coefficients:\n#>      (Intercept)  speciesChinstrap     speciesGentoo  \n#>          3706.16             26.92           1386.27\n```\n\n\n:::\n:::\n\n\n$$\n\\hat Y_i = 3706 + 26.92 (Chinstrap) + 1386.27 (Gentoo)\n$$\n\n## Intepreting $\\hat \\beta_1$\n\nOn average, Chinstrap has a larger mass than Adelie by about 26.92 grams.\n\n## Intepreting $\\hat \\beta_2$\n\nOn average, Gentoo has a larger mass than Adelie by about 1386.27 grams.\n\n\n## Finding the Adelie MASS\n\n$$\n\\hat Y_i = 3706 + 26.92 (0) + 1386.27 (0)\n$$\n\n## Finding the Chinstrap MASS\n\n$$\n\\hat Y_i = 3706 + 26.92 (1) + 1386.27 (0)\n$$\n\n## Finding the Gentoo MASS\n\n$$\n\\hat Y_i = 3706 + 26.92 (0) + 1386.27 (1)\n$$\n\n\n## Prediction in R\n\n::: panel-tabset\n\n### Gentoo\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxlm <- lm(body_mass ~ species,\n            data = penguins)\npredict_df <- data.frame(species = \"Gentoo\")\npredict(xlm,\n        predict_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        1 \n#> 5092.437\n```\n\n\n:::\n:::\n\n\n### Chinstrap\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxlm <- lm(body_mass ~ species,\n            data = penguins)\npredict_df <- data.frame(species = \"Chinstrap\")\npredict(xlm,\n        predict_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        1 \n#> 3733.088\n```\n\n\n:::\n:::\n\n\n### Adelie\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxlm <- lm(body_mass ~ species,\n            data = penguins)\npredict_df <- data.frame(species = \"Adelie\")\npredict(xlm,\n        predict_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        1 \n#> 3706.164\n```\n\n\n:::\n:::\n\n\n\n:::\n\n\n# GLM Example\n\n## Example\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxglm <- glm(disease ~ thal, \n            data = heart_disease, \n            family = binomial())\nxglm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:  glm(formula = disease ~ thal, family = binomial(), data = heart_disease)\n#> \n#> Coefficients:\n#>           (Intercept)       thalFixed Defect  thalReversible Defect  \n#>                -1.233                  1.926                  2.415  \n#> \n#> Degrees of Freedom: 296 Total (i.e. Null);  294 Residual\n#> Null Deviance:\t    409.9 \n#> Residual Deviance: 323.4 \tAIC: 329.4\n```\n\n\n:::\n:::\n\n\n$$\nlo(disease) = -1.233 + 1.926 (Fixed) + 2.415 (Reversible)\n$$\n\n## Intepreting $\\hat \\beta_1$\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nexp(1.926)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 6.862007\n```\n\n\n:::\n:::\n\n\nThe odds of having heart disease is 6.86 times higher for a patient who has a fixed defect than a patient who is normal.\n\n## Intepreting $\\hat \\beta_2$\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nexp(2.415)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 11.18977\n```\n\n\n:::\n:::\n\n\nThe odds of having heart disease is 11.19 times higher for a patient who has a reversible defect than a patient who is normal.\n\n## Prediction in R\n\n::: panel-tabset\n\n### Fixed Defect\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxglm <- glm(disease ~ thal, data = heart_disease,\n            family = binomial())\npdf <- data.frame(thal = \"Fixed Defect\")\npredict(xglm, pdf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.6666667\n```\n\n\n:::\n:::\n\n\n### Reversible Defect\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxglm <- glm(disease ~ thal, data = heart_disease,\n            family = binomial())\npdf <- data.frame(thal = \"Reversible Defect\")\npredict(xglm, pdf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.7652174\n```\n\n\n:::\n:::\n\n\n### Normal\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nxglm <- glm(disease ~ thal, data = heart_disease,\n            family = binomial())\npdf <- data.frame(thal = \"Normal\")\npredict(xglm, pdf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.2256098\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}