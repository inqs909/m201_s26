{
  "hash": "592058087c99cface51578342d6cd67d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: |\n  Simple <br>\n  Logistic Regression\ndescription: |\n  Begins the discussion for logistic regression.\nformat:\n  revealjs:\n    width: 1200\n    scrollable: true\n    sc-sb-title: true\n    footer: m201.inqs.info/lectures/6\n    theme: [default, styles.scss]\n    navigation-mode: vertical\n    controls-layout: edges\n    controls-tutorial: true\n    slide-number: true\n    pointer:\n      pointerSize: 32\n    incremental: false \n    chalkboard:\n      theme: whiteboard\n      chalk-width: 4\nknitr:\n  opts_chunk: \n    echo: true\n    eval: true\n    code-fold: true\n    warnings: false\n    comment: \"#>\" \n    \nrevealjs-plugins:\n  - pointer\n  \nfilters: \n  - reveal-header\n  - code-fullscreen\n  - reveal-auto-agenda\n\neditor: source\n---\n\n## R Packages\n\n\n-   rcistats\n-   tidyverse\n\n\n## Heart Disease Data\n\n::: {.columns}\n::: {.column}\n\n### Variables of Interest\n\n- `age`: Age of patient\n- `disease`: Indicating if they have heart disease\n\n:::\n::: {.column}\n![](img/heart_df.png){fig-alt=\"An image of a graph and a heart.\"}\n:::\n:::\n\n\n\n# Modeling Binary Outcomes\n\n## Modeling Binary Outcomes\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](6_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n## Modeling Binary Outcomes\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](6_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Mathematical Model\n\n$$\n\\left(\\begin{array}{c}\nYes \\\\\nNo\n\\end{array}\\right) = \\beta_0 + \\beta_1X\n$$\n\n## Let ...\n\n$$\nY = \\left\\{\\begin{array}{cc}\n1 & Yes \\\\\n0 & No\n\\end{array}\\right.\n$$\n\n## Construct a Model\n\n$$\nP\\left(Y = 1\\right) = \\beta_0 + \\beta_1X\n$$\n\n## Construct a Model\n\n$$\nP\\left(Y = 1\\right) = \\frac{e^{\\beta_0 + \\beta_1X}}{1 + e^{\\beta_0 + \\beta_1X}}\n$$\n\n## Construct a Model\n\n$$\n\\frac{P(Y = 1)}{P(Y = 0)} = e^{\\beta_0 + \\beta_1X}\n$$\n\nwhere $\\frac{P(Y = 1)}{P(Y = 0)}$ are considered the odds of observing $Y = 1$.\n\n## The Logistic Model\n\n$$\n\\log\\left\\{\\frac{P(Y = 1)}{P(Y = 0)}\\right\\} = \\beta_0 + \\beta_1X\n$$\n\n## Notation\n\n$$\n\\log\\left\\{\\frac{P(Y = 1)}{P(Y = 0)}\\right\\} = \n\\log\\left\\{odds\\ of \\ 1\\right\\} =\nlo(1)\n$$\n\n# Logistic Regression\n\n## Logistic Regression\n\nLogistic Regression is used to model the association between a predictor and a **binary** outcome variable.\n\n::: fragment\nThis is similar Linear Regression which models the association between a predictor and a **numerical** outcome variable.\n:::\n\n## Logistic Regression\n\nLogistic Regression uses the logistic model to formulate the relationship between a predictor and the outcome.\n\n::: fragment\n\nMore specifically, for an outcome of Y:\n\n$$\nY = \\left\\{\\begin{array}{cc}\n1 & \\text{Category 1} \\\\\n0 & \\text{Category 2}\n\\end{array}\\right.\n$$\n\nThe predictor variable will model the probability of observing category 1 ($P(Y=1)$)\n\n:::\n\n\n## Logistic Model\n\n$$\n\\log\\left\\{\\frac{P(Y = 1)}{P(Y = 0)}\\right\\} = \\beta_0 + \\beta_1X\n$$\n\n## Regression Coefficients $\\beta$\n\nThe regression coefficients quantify how a specific predictor changes the odds of observing the first category of the outcome ($Y = 1$)\n\n## Estimating $\\beta$\n\nTo obtain the numerical value for $\\beta$, denoted as $\\hat \\beta$, we will be finding the values of $\\hat \\beta$ that maximizes the likelihood function:\n\n$$\nL(\\boldsymbol \\beta) = \\prod_{i=1}^n \\left(\\frac{e^{\\beta_0 + \\beta_1X}}{1 + e^{\\beta_0 + \\beta_1X}}\\right)^{Y_i}\\left(\\frac{1}{1 + e^{\\beta_0 + \\beta_1X}}\\right)^{1-Y_i}\n$$\n\nThe likelihood function can be thought as the probability of observing the entire data set. Therefore, we want to choose the values the $\\beta_0$ and $\\beta_1$ that will result in the highest probability of observing the data.\n\n\n## Estimated Parameters\n\nThe values you obtain ($\\hat \\beta$) tell you the relationship between the a predictor variable and the log odds of observing the first category of the outcome $Y=1$.\n\n::: fragment\nExponentiating the estimate ($e^{\\hat \\beta}$) will give you the relationship between a predictor variable and the odds of observing the first category of the outcome $Y=1$.\n:::\n\n## Interpreting $\\hat \\beta$\n\nFor a continuous predictor variable:\n\nAs X increases by 1 unit, the odds of observing the first category ($Y = 1$) increases by a factor of $e^{\\hat\\beta}$.\n\n# Logistic Regression in R\n\n## Logistic Regression in R\n\n```r\nxglm <- glm(Y ~ X,\n            data = DATA,\n            family = binomial())\nxglm\n```\n\n- `DATA`: Name of the data frame\n- `Y`: Outcome Variable of Interest in the data frame `DATA`\n- `X`: Predictor Variable in the data frame `DATA`\n\n\n## Model Information\n\nThe `model_info` function can provide basic information about a linear or logistic regression model. \n\n\n::: fragment\nIt can provide what is being modeled (yes, 1) in logistic regression.\n:::\n\n\n::: fragment\nIt can provide basic info of the predictor variables.\n:::\n\n## Model Information in R\n\n```r\nmodel_info(MODEL)\n```\n\n- `MODEL`: fitted model from `lm()` or `glm`\n\n\n## Example\n\nModelling `disease` by `age`: \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nxglm <- glm(disease ~ cp + age + sex + restecg + fbs,\n            data = heart_disease,\n            family = binomial())\nmodel_info(xglm)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Outcome Variable: disease\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#>   Modeling Probability: yes\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Numerical Predictors: \n#>    age\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Categorical Predictors: \n#>   cp: \n#>      Asymptomatic (Reference)  \n#>      Non-anginal Pain  \n#>      Atypical Angina  \n#>      Typical Angina  \n#>   sex: \n#>      Female (Reference)  \n#>      Male  \n#>   restecg: \n#>      Normal (Reference)  \n#>      ST-T wave Abnormality  \n#>      Left Ventricular Hypertrophy  \n#>   fbs: \n#>      Fasting Blood Sugar <= 120 (Reference)  \n#>      Fasting Blood Sugar >120\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nxglm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:  glm(formula = disease ~ cp + age + sex + restecg + fbs, family = binomial(), \n#>     data = heart_disease)\n#> \n#> Coefficients:\n#>                         (Intercept)                   cpNon-anginal Pain  \n#>                            -3.97563                             -2.30854  \n#>                   cpAtypical Angina                     cpTypical Angina  \n#>                            -2.38883                             -2.31736  \n#>                                 age                              sexMale  \n#>                             0.06316                              1.77141  \n#>        restecgST-T wave Abnormality  restecgLeft Ventricular Hypertrophy  \n#>                             1.62429                              0.50215  \n#>         fbsFasting Blood Sugar >120  \n#>                             0.08444  \n#> \n#> Degrees of Freedom: 296 Total (i.e. Null);  288 Residual\n#> Null Deviance:\t    409.9 \n#> Residual Deviance: 286.6 \tAIC: 304.6\n```\n\n\n:::\n:::\n\n\n##\n\n\n$$\nlo(disease) = -3.0512 + 0.0529 (age)\n$$\n\n\n## Interpretation\n\n$$\nlo(disease) = -3.0512 + 0.0529 (age)\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nexp(0.05291)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 1.054335\n```\n\n\n:::\n:::\n\n\n::: fragment\nAs age increases by 1 year, the odds of having heart disease increases by a factor of 1.054.\n:::\n\n# Prediction with Models\n\n## Working with probabilities\n\nAs you can see, working with odds may be unintuitive for the average person. It will be better to predict the probability and display those results to individuals.\n\n## Predicting Probability\n\n\n$$\n\\hat P\\left(Y = 1\\right) = \\frac{e^{\\hat\\beta_0 + \\hat\\beta_1X}}{1 + e^{\\hat\\beta_0 + \\hat\\beta_1X}}\n$$\n\n## Prediction in R\n\n```r\nxglm <- glm(Y ~ X,\n            data = DATA,\n            family = binomial())\nndf <- data.frame(X = VAL)\npredict(xglm,\n        ndf,\n        type = \"response\")\n```\n\n\n## Example 1\n\nPredict the probability of having heart disease for a patient who is 40 years old.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nxglm <- glm(disease ~ age,\n            data = heart_disease,\n            family = binomial())\nndf <- data.frame(age = 40)\npredict(xglm, ndf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.2819196\n```\n\n\n:::\n:::\n\n\n\n## Example 2\n\nPredict the probability of having heart disease for a patient who is 55 years old.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nxglm <- glm(disease ~ age,\n            data = heart_disease,\n            family = binomial())\nndf <- data.frame(age = 55)\npredict(xglm, ndf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.4647183\n```\n\n\n:::\n:::\n\n\n## Example 3\n\nPredict the probability of having heart disease for a patient who is 70 years old.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nxglm <- glm(disease ~ age,\n            data = heart_disease,\n            family = binomial())\nndf <- data.frame(age = 70)\npredict(xglm, ndf, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1 \n#> 0.6575143\n```\n\n\n:::\n:::\n\n\n## Example\n\n| Age | 40 | 55 | 70 |\n|:-|:-|:-|:-|\n| Probabiltiy | 28.2% | 46.5% | 65.8% |\n\n\n\n\n",
    "supporting": [
      "6_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}